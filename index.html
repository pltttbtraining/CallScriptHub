<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RH5 Script Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #B3E0FF;
            --secondary: #99CCFF;
            --accent: #CCE5FF;
            --light: rgba(255, 255, 255, 0.85);
            --dark: #2C3E50;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --gray: #7E7E9C;
            --border-radius: 16px;
            --box-shadow: 0 8px 32px rgba(179, 224, 255, 0.15);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Prompt', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #F5FBFF 0%, #EBF7FF 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Loading Screen */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: var(--transition);
        }

        .loading-content {
            text-align: center;
            color: white;
            padding: 2rem;
        }

        .loading-logo {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            animation: pulse 2s infinite;
        }

        .loading-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
        }

        .loading-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0;
            animation: fadeInUp 1s ease 1s forwards;
        }

        .start-btn {
            background: rgba(255,255,255,0.3);
            color: white;
            border: 2px solid white;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0;
            animation: fadeInUp 1s ease 1.5s forwards;
            backdrop-filter: blur(10px);
        }

        .start-btn:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        /* Main App */
        #mainApp {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Navigation Bar */
        .nav-bar {
            display: flex;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 0.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--box-shadow);
            overflow-x: auto;
            scrollbar-width: none;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .nav-bar::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            padding: 0.8rem 1.2rem;
            background: transparent;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            white-space: nowrap;
            color: var(--dark);
            flex-shrink: 0;
        }

        .nav-item.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(179, 224, 255, 0.4);
        }

        .nav-item:not(.active):hover {
            background: rgba(179, 224, 255, 0.3);
        }

        /* Admin Controls */
        .admin-controls {
            display: none;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .admin-controls.active {
            display: block;
        }

        .admin-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .admin-btn {
            padding: 0.6rem 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .admin-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .admin-btn.delete {
            background: var(--danger);
        }

        .admin-btn.delete:hover {
            background: #d32f2f;
        }

        /* ปุ่มออกจากระบบแอดมิน */
        .btn-logout {
            background-color: #ffcccc;
            color: #cc0000;
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .btn-logout:hover {
            background-color: #ff9999;
            transform: translateY(-2px);
        }

        /* Content Area */
        .content-area {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            min-height: 500px;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .page {
            display: none;
            animation: slideIn 0.3s ease forwards;
        }

        .page.active {
            display: block;
        }

        /* Home Page */
        .welcome-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--dark);
            font-weight: 500;
        }

        .quick-access {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .quick-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: var(--box-shadow);
        }

        .quick-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(179, 224, 255, 0.2);
        }

        .quick-item i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        /* Scripts Page */
        .script-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .script-tabs::-webkit-scrollbar {
            display: none;
        }

        .script-tab {
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.5);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            white-space: nowrap;
            color: var(--dark);
            flex-shrink: 0;
        }

        .script-tab.active {
            background: var(--primary);
            color: white;
        }

        .script-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .script-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border-left: 4px solid var(--primary);
            transition: var(--transition);
            cursor: pointer;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .script-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(179, 224, 255, 0.2);
        }

        .script-card h3 {
            color: var(--dark);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .script-content {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .script-bullets {
            margin-top: 1rem;
            padding-left: 1.2rem;
        }

        .script-bullets li {
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .full-script {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.85rem;
            display: none;
            backdrop-filter: blur(10px);
            white-space: pre-line;
            line-height: 1.5;
        }

        /* Objection Handling */
        .category-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .category-tabs::-webkit-scrollbar {
            display: none;
        }

        .category-tab {
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.5);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            white-space: nowrap;
            color: var(--dark);
            flex-shrink: 0;
        }

        .category-tab.active {
            background: var(--primary);
            color: white;
        }

        .objection-list {
            display: grid;
            gap: 1rem;
        }

        .objection-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .objection-question {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .objection-answer {
            color: var(--gray);
            margin-bottom: 0.5rem;
            display: none;
        }

        .objection-tone {
            color: var(--primary);
            font-size: 0.85rem;
            font-style: italic;
        }

        /* Techniques Page */
        .technique-list {
            display: grid;
            gap: 1rem;
        }

        .technique-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .technique-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(179, 224, 255, 0.2);
        }

        .technique-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .technique-title {
            font-weight: 600;
            color: var(--dark);
        }

        .technique-details {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: none;
        }

        /* Tools Page */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .tool-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
        }

        .tool-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(179, 224, 255, 0.2);
        }

        .tool-item i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        /* Forms */
        .form-container {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.6);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Admin Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            padding: 2rem;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-wide {
            max-width: 800px;
        }

        .modal input {
            width: 100%;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.2rem;
            letter-spacing: 0.2rem;
            background: rgba(255, 255, 255, 0.6);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* Conversation Builder */
        .conversation-builder {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 1.5rem;
        }

        .conversation-nodes {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            max-height: 500px;
            overflow-y: auto;
        }

        .conversation-flow {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            min-height: 500px;
        }

        .node-item {
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .node-item:hover {
            background: rgba(179, 224, 255, 0.3);
        }

        .node-item.active {
            background: var(--primary);
            color: white;
        }

        .flow-step {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary);
        }

        .flow-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .flow-option {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 0.8rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .flow-option:hover {
            background: rgba(179, 224, 255, 0.3);
        }

        /* File Upload */
        .upload-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .file-input {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 1rem;
            border: 1px dashed var(--primary);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.5);
        }

        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
        }

        /* Script Designer Styles */
        .script-designer {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 1.5rem;
            height: 600px;
        }

        .script-components {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            overflow-y: auto;
        }

        .script-preview {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.4);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .component-category {
            margin-bottom: 1.5rem;
        }

        .component-category h4 {
            margin-bottom: 0.5rem;
            color: var(--dark);
            border-bottom: 1px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        .component-item {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .component-item:hover {
            background: rgba(179, 224, 255, 0.3);
            transform: translateY(-2px);
        }

        .component-item.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .script-structure {
            flex-grow: 1;
            min-height: 400px;
            border: 2px dashed var(--primary);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.5);
        }

        .structure-section {
            margin-bottom: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .section-title {
            font-weight: 600;
            color: var(--dark);
        }

        .section-content {
            color: var(--gray);
        }

        .empty-section {
            text-align: center;
            color: var(--gray);
            padding: 2rem;
            font-style: italic;
        }

        .phrase-options {
            display: none;
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .phrase-option {
            padding: 0.5rem;
            margin-bottom: 0.3rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .phrase-option:hover {
            background: rgba(179, 224, 255, 0.3);
        }

        .designer-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .custom-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 4px;
            margin-top: 0.5rem;
            background: rgba(255, 255, 255, 0.7);
        }

        .template-item {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .template-item:hover {
            background: rgba(179, 224, 255, 0.3);
            transform: translateY(-2px);
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .script-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-bar {
                padding: 0.5rem;
            }
            
            .nav-item {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .loading-title {
                font-size: 2rem;
            }
            
            .loading-subtitle {
                font-size: 1rem;
            }
            
            .quick-access {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tools-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .admin-buttons {
                flex-direction: column;
            }
            
            .conversation-builder {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .script-designer {
                grid-template-columns: 1fr;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-headset"></i>
            </div>
            <h1 class="loading-title">RH5 Script Hub</h1>
            <p class="loading-subtitle">ระบบจัดการสคริปต์การโทรแบบมืออาชีพ</p>
            <button class="start-btn" onclick="startApp()">
                <i class="fas fa-play"></i> เริ่มใช้งาน
            </button>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp">
        <!-- Navigation Bar -->
        <div class="nav-bar">
            <button class="nav-item active" data-page="home">หน้าแรก</button>
            <button class="nav-item" data-page="scripts">คลังสคริปต์</button>
            <button class="nav-item" data-page="script-designer">ออกแบบสคริปต์</button>
            <button class="nav-item" data-page="objection-handling">จัดการข้อโต้แย้ง</button>
            <button class="nav-item" data-page="conversation-builder">Conversation Builder</button>
            <button class="nav-item" data-page="techniques">เทคนิคพิเศษ</button>
            <button class="nav-item" data-page="tools">Tools</button>
            <button class="nav-item" onclick="showAdminModal()">
                <i class="fas fa-cog"></i>
            </button>
        </div>

        <!-- Admin Controls - เพิ่มส่วนอัพโหลดไฟล์ -->
        <div id="adminControls" class="admin-controls">
            <h3>การจัดการระบบ (Admin)</h3>
            <div class="admin-buttons">
                <button class="admin-btn" onclick="showAddScriptModal()">เพิ่มสคริปต์</button>
                <button class="admin-btn" onclick="showAddObjectionModal()">เพิ่มข้อโต้แย้ง</button>
                <button class="admin-btn" onclick="showAddConversationModal()">เพิ่ม Conversation</button>
                <button class="admin-btn" onclick="showAddTechniqueModal()">เพิ่มเทคนิค</button>
                <button class="admin-btn" onclick="showAddComponentModal()">เพิ่ม Component</button>
                <button class="btn-logout" onclick="logoutAdmin()">ออกจากระบบแอดมิน</button>
                <button class="admin-btn delete" onclick="clearAllData()">ล้างข้อมูลทั้งหมด</button>
            </div>
            
            <!-- ย้ายส่วนอัพโหลดไฟล์มาที่นี่ -->
            <div class="upload-section">
                <h3>อัพโหลดไฟล์</h3>
                <input type="file" class="file-input" id="fileUpload" multiple>
                <button class="admin-btn" onclick="uploadFiles()">อัพโหลดไฟล์</button>
                
                <div class="file-list" id="fileList">
                    <!-- Uploaded files will be listed here -->
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Home Page -->
            <div id="home" class="page active">
                <div class="welcome-card">
                    <h2>ยินดีต้อนรับสู่ RH5 Script Hub</h2>
                    <p>ระบบจัดการสคริปต์การโทรและเทคนิคการขายแบบมืออาชีพ</p>
                </div>
                
                <div class="stats-grid" id="statsGrid">
                    <!-- Statistics will be loaded here -->
                </div>
                
                <h3 style="margin-bottom: 1rem;">เมนูด่วน</h3>
                <div class="quick-access">
                    <div class="quick-item" data-page="scripts">
                        <i class="fas fa-file-alt"></i>
                        <h4>คลังสคริปต์</h4>
                        <p>จัดการสคริปต์การโทรทั้งหมด</p>
                    </div>
                    
                    <div class="quick-item" data-page="script-designer">
                        <i class="fas fa-edit"></i>
                        <h4>ออกแบบสคริปต์</h4>
                        <p>สร้างสคริปต์แบบ Customize</p>
                    </div>
                    
                    <div class="quick-item" data-page="objection-handling">
                        <i class="fas fa-bolt"></i>
                        <h4>จัดการข้อโต้แย้ง</h4>
                        <p>เทคนิคการตอบคำถามลูกค้า</p>
                    </div>
                    
                    <div class="quick-item" data-page="conversation-builder">
                        <i class="fas fa-comments"></i>
                        <h4>Conversation Builder</h4>
                        <p>สร้างบทสนทนาแบบไดนามิก</p>
                    </div>
                </div>
            </div>

            <!-- Scripts Page -->
            <div id="scripts" class="page">
                <h2>คลังสคริปต์</h2>
                <p>จัดการสคริปต์การโทรทั้งหมดของคุณ</p>
                
                <div class="script-tabs">
                    <button class="script-tab active" data-type="call">Call Scripts</button>
                    <button class="script-tab" data-type="counter">Counter Conversation</button>
                </div>
                
                <div id="callScripts" class="script-tab-content">
                    <div class="script-grid" id="callScriptsList">
                        <!-- Call scripts will be loaded here -->
                    </div>
                </div>
                
                <div id="counterScripts" class="script-tab-content" style="display: none;">
                    <div class="script-grid" id="counterScriptsList">
                        <!-- Counter scripts will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Script Designer Page -->
            <div id="script-designer" class="page">
                <h2>ออกแบบสคริปต์</h2>
                <p>สร้างสคริปต์แบบ Customize โดยเลือกจาก Component สำเร็จรูป</p>
                
                <div class="script-tabs">
                    <button class="script-tab active" data-template="custom">ออกแบบเอง</button>
                    <button class="script-tab" data-template="quick">เทมเพลตสำเร็จรูป</button>
                </div>
                
                <div id="customDesigner" class="script-designer">
                    <div class="script-components">
                        <h3>ส่วนประกอบสคริปต์</h3>
                        
                        <div class="component-category">
                            <h4>การเริ่มต้นบทสนทนา</h4>
                            <div id="openingComponents">
                                <!-- Opening components will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="component-category">
                            <h4>การระบุปัญหา</h4>
                            <div id="painPointComponents">
                                <!-- Pain point components will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="component-category">
                            <h4>การนำเสนอโซลูชัน</h4>
                            <div id="solutionComponents">
                                <!-- Solution components will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="component-category">
                            <h4>การปิดการขาย</h4>
                            <div id="closingComponents">
                                <!-- Closing components will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="component-category">
                            <h4>ประโยคพิเศษ</h4>
                            <div id="specialComponents">
                                <!-- Special components will be loaded here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="script-preview">
                        <h3>สคริปต์ของคุณ</h3>
                        <div class="script-structure" id="scriptStructure">
                            <div class="empty-section">เลือกส่วนประกอบจากด้านซ้ายเพื่อสร้างสคริปต์</div>
                        </div>
                        
                        <div class="designer-actions">
                            <button class="admin-btn" onclick="clearScriptDesign()">ล้างทั้งหมด</button>
                            <button class="admin-btn" onclick="saveDesignedScript()">บันทึกสคริปต์</button>
                            <button class="start-btn" onclick="exportScript()">ส่งออกสคริปต์</button>
                        </div>
                    </div>
                </div>
                
                <div id="templateDesigner" style="display: none;">
                    <h3>เทมเพลตสคริปต์สำเร็จรูป</h3>
                    <p>เลือกเทมเพลตแล้วปรับแต่งตามต้องการ</p>
                    
                    <div class="template-grid" id="templateList">
                        <!-- Templates will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Objection Handling Page -->
            <div id="objection-handling" class="page">
                <h2>จัดการข้อโต้แย้ง</h2>
                <p>เทคนิคการตอบคำถามและข้อโต้แย้งจากลูกค้า</p>
                
                <div class="category-tabs">
                    <button class="category-tab active" data-category="call">Call Scripts</button>
                    <button class="category-tab" data-category="counter">Counter Scripts</button>
                    <button class="category-tab" data-category="general">ทั่วไป</button>
                </div>
                
                <div class="objection-list" id="objectionList">
                    <!-- Objections will be loaded here -->
                </div>
            </div>

            <!-- Conversation Builder Page -->
            <div id="conversation-builder" class="page">
                <h2>Conversation Builder</h2>
                <p>สร้างบทสนทนาแบบไดนามิกพร้อมเส้นทางเลือกหลากหลาย</p>
                
                <div class="conversation-builder">
                    <div class="conversation-nodes">
                        <h3>โหนดบทสนทนา</h3>
                        <div id="conversationNodesList">
                            <!-- Conversation nodes will be loaded here -->
                        </div>
                    </div>
                    <div class="conversation-flow">
                        <h3>เส้นทางบทสนทนา</h3>
                        <div id="conversationFlow">
                            <p>เลือกบทสนทนาจากรายการด้านซ้ายเพื่อเริ่มต้น</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Techniques Page -->
            <div id="techniques" class="page">
                <h2>เทคนิคพิเศษ</h2>
                <p>เทคนิคการขายและบริการลูกค้าขั้นสูง</p>
                
                <div class="technique-list" id="techniqueList">
                    <!-- Techniques will be loaded here -->
                </div>
            </div>

            <!-- Tools Page - เอาการอัพโหลดไฟล์ออก -->
            <div id="tools" class="page">
                <h2>Tools</h2>
                <p>เครื่องมือและทรัพยากรสำหรับทีมงาน</p>
                
                <div class="tools-grid" id="toolsList">
                    <!-- Tools will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeAdminModal()">&times;</button>
            <h2>Admin Access</h2>
            <p>กรุณากรอกรหัสผ่าน</p>
            <input type="password" id="adminPasscode" placeholder="รหัสผ่าน" maxlength="4">
            <button class="start-btn" onclick="checkAdminPasscode()" style="margin-top: 1rem;">
                ยืนยัน
            </button>
        </div>
    </div>

    <!-- Add Script Modal -->
    <div id="addScriptModal" class="modal">
        <div class="modal-content modal-wide">
            <button class="close-btn" onclick="closeAddScriptModal()">&times;</button>
            <h2>เพิ่มสคริปต์ใหม่</h2>
            <div class="form-container">
                <div class="form-group">
                    <label for="scriptType">ประเภทสคริปต์</label>
                    <select id="scriptType">
                        <option value="call">Call Script</option>
                        <option value="counter">Counter Script</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scriptTitle">ชื่อสคริปต์</label>
                    <input type="text" id="scriptTitle" placeholder="ชื่อสคริปต์">
                </div>
                <div class="form-group">
                    <label for="scriptBullets">รายการ Bullet Points (แต่ละบรรทัดเป็น 1 bullet)</label>
                    <textarea id="scriptBullets" placeholder="แต่ละบรรทัดเป็น 1 bullet point"></textarea>
                </div>
                <div class="form-group">
                    <label for="scriptFull">สคริปต์เต็ม</label>
                    <textarea id="scriptFull" placeholder="สคริปต์เต็มรูปแบบ"></textarea>
                </div>
                <button class="start-btn" onclick="addNewScript()">เพิ่มสคริปต์</button>
            </div>
        </div>
    </div>

    <!-- Add Objection Modal -->
    <div id="addObjectionModal" class="modal">
        <div class="modal-content modal-wide">
            <button class="close-btn" onclick="closeAddObjectionModal()">&times;</button>
            <h2>เพิ่มข้อโต้แย้งใหม่</h2>
            <div class="form-container">
                <div class="form-group">
                    <label for="objectionCategory">หมวดหมู่</label>
                    <select id="objectionCategory">
                        <option value="call">Call Scripts</option>
                        <option value="counter">Counter Scripts</option>
                        <option value="general">ทั่วไป</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="objectionQuestion">ข้อโต้แย้งจากลูกค้า</label>
                    <input type="text" id="objectionQuestion" placeholder="ข้อโต้แย้งจากลูกค้า">
                </div>
                <div class="form-group">
                    <label for="objectionAnswer">คำตอบแนะนำ</label>
                    <textarea id="objectionAnswer" placeholder="คำตอบแนะนำ"></textarea>
                </div>
                <div class="form-group">
                    <label for="objectionTone">โทนเสียงแนะนำ</label>
                    <input type="text" id="objectionTone" placeholder="โทนเสียงแนะนำ">
                </div>
                <button class="start-btn" onclick="addNewObjection()">เพิ่มข้อโต้แย้ง</button>
            </div>
        </div>
    </div>

    <!-- Add Conversation Modal -->
    <div id="addConversationModal" class="modal">
        <div class="modal-content modal-wide">
            <button class="close-btn" onclick="closeAddConversationModal()">&times;</button>
            <h2>เพิ่ม Conversation ใหม่</h2>
            <div class="form-container">
                <div class="form-group">
                    <label for="conversationTitle">ชื่อบทสนทนา</label>
                    <input type="text" id="conversationTitle" placeholder="ชื่อบทสนทนา">
                </div>
                <div class="form-group">
                    <label for="conversationNodes">โหนดบทสนทนา (รูปแบบ JSON)</label>
                    <textarea id="conversationNodes" placeholder='[{"id": "node1", "content": "เนื้อหา", "options": [{"text": "ตัวเลือก", "next": "node2"}]}]'></textarea>
                </div>
                <button class="start-btn" onclick="addNewConversation()">เพิ่มบทสนทนา</button>
            </div>
        </div>
    </div>

    <!-- Add Technique Modal -->
    <div id="addTechniqueModal" class="modal">
        <div class="modal-content modal-wide">
            <button class="close-btn" onclick="closeAddTechniqueModal()">&times;</button>
            <h2>เพิ่มเทคนิคใหม่</h2>
            <div class="form-container">
                <div class="form-group">
                    <label for="techniqueTitle">ชื่อเทคนิค</label>
                    <input type="text" id="techniqueTitle" placeholder="ชื่อเทคนิค">
                </div>
                <div class="form-group">
                    <label for="techniqueDescription">คำอธิบาย</label>
                    <textarea id="techniqueDescription" placeholder="คำอธิบายเทคนิค"></textarea>
                </div>
                <div class="form-group">
                    <label for="techniqueSteps">ขั้นตอน (แต่ละบรรทัดเป็น 1 ขั้นตอน)</label>
                    <textarea id="techniqueSteps" placeholder="แต่ละบรรทัดเป็น 1 ขั้นตอน"></textarea>
                </div>
                <button class="start-btn" onclick="addNewTechnique()">เพิ่มเทคนิค</button>
            </div>
        </div>
    </div>

    <!-- Add Component Modal -->
    <div id="addComponentModal" class="modal">
        <div class="modal-content modal-wide">
            <button class="close-btn" onclick="closeAddComponentModal()">&times;</button>
            <h2>เพิ่ม Component ใหม่</h2>
            <div class="form-container">
                <div class="form-group">
                    <label for="componentCategory">หมวดหมู่</label>
                    <select id="componentCategory">
                        <option value="opening">การเริ่มต้นบทสนทนา</option>
                        <option value="painPoint">การระบุปัญหา</option>
                        <option value="solution">การนำเสนอโซลูชัน</option>
                        <option value="closing">การปิดการขาย</option>
                        <option value="special">ประโยคพิเศษ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="componentTitle">ชื่อ Component</label>
                    <input type="text" id="componentTitle" placeholder="ชื่อ Component">
                </div>
                <div class="form-group">
                    <label for="componentContent">เนื้อหา</label>
                    <textarea id="componentContent" placeholder="เนื้อหา Component"></textarea>
                </div>
                <div class="form-group">
                    <label for="componentVariations">ตัวเลือกย่อย (แต่ละบรรทัดเป็น 1 ตัวเลือก)</label>
                    <textarea id="componentVariations" placeholder="ตัวเลือกย่อย (ถ้ามี)"></textarea>
                </div>
                <button class="start-btn" onclick="addNewComponent()">เพิ่ม Component</button>
            </div>
        </div>
    </div>

    <script>
        // Default Data
        const defaultCallScripts = [
            {
                id: 1,
                title: "เงินนิ่งในบัญชีเงินฝากเยอะเกินไป",
                bullets: [
                    "OBJECTIVE: เสนอผลิตภัณฑ์การลงทุนที่ให้ผลตอบแทนสูงกว่าเงินฝาก",
                    "OPENER: สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าบัญชีเงินฝากของคุณมียอดคงเหลือค่อนข้างสูง อยากแนะนำโอกาสในการลงทุนที่ให้ผลตอบแทนดีกว่าดอกเบี้ยเงินฝากทั่วไปครับ/ค่ะ",
                    "PAIN: ดอกเบี้ยเงินฝากในปัจจุบันต่ำมาก ทำให้เงินฝากเติบโตช้าและอาจไม่ชนะอัตราเงินเฟ้อ ซึ่งหมายความว่าคุณกำลังสูญเสียมูลค่าของเงินจริงๆ ไปเรื่อยๆ",
                    "URGENCY: โอกาสในการลงทุนที่ดีมักมีจำกัด และยิ่งเริ่มต้นเร็ว ยิ่งได้รับผลตอบแทนที่มากขึ้นในระยะยาว"
                ],
                fullScript: `แนวทางที่ 1: อัปเดตข้อมูล 
	•	หลังจาก ทำธุรกรรมเสร็จ
	•	"... ขออัปเดตข้อมูลที่อยู่ ให้เป็นปัจจุบัน เพื่อการจัดส่งเอกสารสำคัญ เช่น หนังสือรับรองดอกเบี้ย จะได้ใช้สิทธิลดหย่อนภาษี"
	•	"นี้ก็โค้งสุดท้ายของปีแล้ว ไม่ทราบว่าปีนี้ได้เตรียมวางแผนลดหย่อนภาษีไว้หรือยังครับ/คะ?"
"ถ้ากำลังมองหาตัวช่วยใช้สิทธิ์ภาษีให้คุ้ม ผมมีไอเดียหนึ่งอยากแชร์ครับ"
ต่อที่ 1 — ประหยัดภาษี
	•	"ลดหย่อนได้สูงสุด 100,000 บาท"
	•	"ถ้าอยู่ฐาน 20% เท่ากับประหยัดทันที 20,000 บาท"
ต่อที่ 2 — การันตีผลตอบแทน
	•	"คืนทุกปี 4% (ปี 1–9)"
	•	"ครบ 10 ปีรับ 404%"
ต่อที่ 3 — โปรโมชั่นแรงสุด
	•	"เบี้ย 100k = Cash Back 6%"
	•	"เบี้ย 500k+ = iPhone 17 Pro Max"

ผลิตภัณฑ์นี้ พิเศษตรงที่คุณลูกค้า สามารถดูรายละเอียดทั้งหมด รวมถึงสมัครได้ด้วยตัวเองเลยผ่าน ttb touch ครับ/ค่ะ แต่หากยังมีข้อสงสัย พนักงานยินดีช่วยให้คำตอบเพิ่มให้ทันทีนะครับ/คะ
สำหรับการเข้าใช้งาน ก็ไม่ยาก ขออนุญาตแนะนำการเข้าไปใช้งานใน ttb Touch เพิ่มเติมนะครับ/คะ `
            },
            {
                id: 2,
                title: "เงินฝากประจำกำลังจะครบ",
                bullets: [
                    "OBJECTIVE: เสนอทางเลือกการลงทุนที่หลากหลายแทนการต่ออายุเงินฝาก",
                    "OPENER: สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าเงินฝากประจำของคุณใกล้ครบกำหนดแล้ว อยากเสนอทางเลือกการลงทุนที่น่าสนใจให้พิจารณาครับ/ค่ะ",
                    "PAIN: การต่ออายุเงินฝากประจำโดยอัตโนมัติอาจทำให้พลาดโอกาสการลงทุนที่ให้ผลตอบแทนสูงกว่า และดอกเบี้ยเงินฝากในปัจจุบันอยู่ในระดับต่ำมาก",
                    "URGENCY: การตัดสินใจในช่วงเวลานี้สำคัญมาก เพราะจะกำหนดผลตอบแทนของคุณในอีก 12 เดือนข้างหน้า หากเลือกผลิตภัณฑ์ที่เหมาะสมจะได้รับผลตอบแทนที่สูงกว่า"
                ],
                fullScript: `แนวทางที่ 2: เงินฝากประจำกำลังจะครบ
	•	"เห็นว่าบัญชีเงินฝากประจำของคุณกำลังจะครบกำหนดในอีก X วัน"
	•	"การต่ออายุอัตโนมัติอาจทำให้พลาดโอกาสลงทุนที่ให้ผลตอบแทนดีกว่า"
	•	"เรามีผลิตภัณฑ์การลงทุนหลายรูปแบบที่เหมาะสมกับระดับความเสี่ยงที่คุณรับได้"

ข้อมูลผลิตภัณฑ์:
	•	กองทุนรวมตราสารหนี้: ความเสี่ยงต่ำ ผลตอบแทน 2-3%
	•	กองทุนรวมผสม: ความเสี่ยงปานกลาง ผลตอบแทน 4-6%
	•	กองทุนรวมหุ้น: ความเสี่ยงสูง ผลตอบแทน 7-10%+

สามารถเลือกลงทุนตามระดับความเสี่ยงที่คุณสะดวกใจ และมีผู้จัดการกองทุนคอยดูแลให้ครับ/คะ`
            },
            {
                id: 3,
                title: "กองทุนติดลบจากความผันผวนของเศรษฐกิจ",
                bullets: [
                    "OBJECTIVE: เสนอการปรับพอร์ตการลงทุนเพื่อลดความเสี่ยงและฟื้นตัวจากภาวะติดลบ",
                    "OPENER: สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าพอร์ตการลงทุนกองทุนของคุณได้รับผลกระทบจากความผันผวนของเศรษฐกิจ อยากเสนอแนวทางการปรับพอร์ตใหม่ให้เหมาะสมยิ่งขึ้นครับ/ค่ะ",
                    "PAIN: การที่พอร์ตการลงทุนติดลบเป็นเวลานานอาจทำให้สูญเสียโอกาสในการลงทุนอื่นๆ และส่งผลต่อเป้าหมายทางการเงินในระยะยาว",
                    "URGENCY: การปรับพอร์ตในช่วงนี้จะช่วยลดความเสี่ยงและเตรียมพร้อมสำหรับการฟื้นตัวของตลาด ซึ่งจะช่วยให้พอร์ตของคุณกลับมาเติบโตได้เร็วกว่า"
                ],
                fullScript: `แนวทางที่ 3: กองทุนติดลบจากความผันผวน
	•	"ในช่วงเศรษฐกิจผันผวน การลงทุนหลายประเภทได้รับผลกระทบ"
	•	"เรามีบริการปรับพอร์ตการลงทุนฟรี โดยผู้เชี่ยวชาญ"
	•	"จะช่วยวิเคราะห์และแนะนำการปรับสัดส่วนการลงทุนที่เหมาะสม"

ขั้นตอนการปรับพอร์ต:
	1. วิเคราะห์พอร์ตปัจจุบันและระดับความเสี่ยง
	2. ประเมินเป้าหมายการลงทุนและระยะเวลา
	3. แนะนำการปรับสัดส่วนพอร์ตให้เหมาะสม
	4. ติดตามผลและปรับเปลี่ยนตามสถานการณ์

บริการนี้ไม่มีค่าใช้จ่ายเพิ่มเติม และช่วยลดความเสี่ยงจากการลงทุนในสินทรัพย์เดียว`
            },
            {
                id: 4,
                title: "ลูกค้าประกันจ่ายเบี้ยครบ ทบทวนผลิตภัณฑ์",
                bullets: [
                    "OBJECTIVE: เสนอการทบทวนแผนประกันและผลิตภัณฑ์เสริมเพื่อความคุ้มครองที่สมบูรณ์",
                    "OPENER: สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าคุณได้จ่ายเบี้ยประกันชีวิตครบตามสัญญาแล้ว อยากเชิญชวนให้ทบทวนแผนประกันเพื่อตรวจสอบความคุ้มครองที่ยังขาดและโอกาสในการใช้สิทธิลดหย่อนภาษีครับ/ค่ะ",
                    "PAIN: ความต้องการประกันชีวิตเปลี่ยนแปลงตามช่วงวัยและสถานการณ์ การไม่ทบทวนแผนประกันอย่างสม่ำเสมออาจทำให้มีความคุ้มครองไม่เพียงพอหรือซ้ำซ้อน",
                    "URGENCY: การทำประกันในช่วงอายุน้อยกว่าเบี้ยจะถูกกว่าและได้รับความคุ้มครองเร็วขึ้น รวมถึงสามารถใช้สิทธิลดหย่อนภาษีในปีนี้ได้ทันเวลา"
                ],
                fullScript: `แนวทางที่ 4: ลูกค้าประกันจ่ายเบี้ยครบ
	•	"ขอแสดงความยินดีที่คุณได้จ่ายเบี้ยประกันครบตามสัญญา"
	•	"นี่เป็นเวลาที่ดีในการทบทวนความคุ้มครองและแผนการเงิน"
	•	"เรามีผลิตภัณฑ์เสริมที่ช่วยเพิ่มความคุ้มครองและสิทธิลดหย่อนภาษี"

ข้อเสนอพิเศษ:
	•	ประกันสุขภาพเพิ่มเติม: เบี้ยเริ่มต้น 5,000 บาท/ปี
	•	ประกันโรคร้ายแรง: ความคุ้มครองสูงสุด 1,000,000 บาท
	•	ประกันอุบัติเหตุ: ความคุ้มครอง 24 ชม. ทั่วโลก

ทำตอนนี้ได้รับสิทธิ์:
	•	เบี้ยประกันถูกกว่าอายุเพิ่มขึ้น
	•	คุ้มครองเร็วขึ้น ไม่ต้องรอระยะเวลารอคอย
	•	ใช้สิทธิลดหย่อนภาษีได้ในปีนี้`
            },
            {
                id: 5,
                title: "ลูกค้าทั่วไปช่วง Tax Season",
                bullets: [
                    "OBJECTIVE: เชิญชวนใช้บริการคำนวณภาษีและวางแผนการลงทุนเพื่อลดหย่อนภาษี",
                    "OPENER: สวัสดีครับ/คะ คุณลูกค้า ช่วงสิ้นปีนี้เป็นเวลาที่เหมาะสำหรับการวางแผนภาษี ผม/ดิฉันอยากเชิญชวนคุณมาใช้บริการคำนวณภาษีและวางแผนการลดหย่อนภาษีโดยไม่เสียค่าใช้จ่ายครับ/ค่ะ",
                    "PAIN: การไม่วางแผนภาษีล่วงหน้าอาจทำให้ต้องเสียภาษีในอัตราที่สูงขึ้นและพลาดโอกาสในการใช้สิทธิลดหย่อนภาษีต่างๆ ซึ่งหมายถึงการจ่ายเงินมากเกินจำเป็น",
                    "URGENCY: ต้องรีบตัดสินใจในช่วงนี้เพราะจะสิ้นปีแล้ว และโปรโมชั่นต่างๆ สำหรับผลิตภัณฑ์ลดหย่อนภาษีมีข้อเสนอที่ดีที่สุดในช่วงนี้"
                ],
                fullScript: `แนวทางที่ 5: Tax Season
	•	"ช่วงสิ้นปีนี้เป็นเวลาสำคัญสำหรับการวางแผนภาษี"
	•	"ธนาคารมีบริการคำนวณภาษีและวางแผนลดหย่อนโดยไม่เสียค่าใช้จ่าย"
	•	"โปรโมชั่นพิเศษมีเฉพาะช่วงสิ้นปีนี้เท่านั้น"

บริการฟรีสำหรับลูกค้า:
	•	คำนวณภาษีโดยประมาณล่วงหน้า
	•	วิเคราะห์สิทธิลดหย่อนภาษีที่ใช้ได้
	•	แนะนำผลิตภัณฑ์ลดหย่อนภาษีที่เหมาะสม

โปรโมชั่นพิเศษ:
	•	สมัครประกันชีวิต: ได้รับของสมนาคุณมูลค่า 1,000 บาท
	•	ลงทุนกองทุน RMF: ได้ส่วนลดค่าธรรมเนียม 50%
	•	ซื้อสินทรัพย์ดิจิทัล: ได้รับคู่มือการลดหย่อนภาษี

ต้องรีบตัดสินใจเพราะโปรโมชั่นมีจำกัดและสิ้นปีกำลังจะถึง!`
            }
        ];

        const defaultCounterScripts = [
            {
                id: 1,
                title: "ขออัพเดทข้อมูลที่อยู่",
                bullets: [
                    "STEP1: ยืนยันข้อมูลลูกค้าและแจ้งวัตถุประสงค์: 'สวัสดีครับ/คะ คุณลูกค้า วันนี้โทรมาเพื่อขออัพเดทข้อมูลที่อยู่ให้เป็นปัจจุบันครับ/คะ เพื่อให้แน่ใจว่าสามารถส่งเอกสารสำคัญได้อย่างถูกต้อง'",
                    "STEP2: สร้างโอกาสในการขาย: 'นอกจากนี้ ผม/ดิฉันอยากใช้โอกาสนี้แจ้งว่าเรามีผลิตภัณฑ์ใหม่ที่เหมาะกับคุณ ซึ่งสามารถช่วยลดหย่อนภาษีได้สูงสุด 100,000 บาท และมีโปรโมชั่นพิเศษในช่วงสิ้นปีนี้'"
                ],
                fullScript: `Counter Conversation 1: ขออัพเดทข้อมูลที่อยู่

STEP1:
"สวัสดีครับ/คะ คุณลูกค้า วันนี้โทรมาเพื่อขออัพเดทข้อมูลที่อยู่ให้เป็นปัจจุบันครับ/คะ เพื่อให้แน่ใจว่าสามารถส่งเอกสารสำคัญได้อย่างถูกต้อง"

STEP2:
"นอกจากนี้ ผม/ดิฉันอยากใช้โอกาสนี้แจ้งว่าเรามีผลิตภัณฑ์ใหม่ที่เหมาะกับคุณ ซึ่งสามารถช่วยลดหย่อนภาษีได้สูงสุด 100,000 บาท และมีโปรโมชั่นพิเศษในช่วงสิ้นปีนี้"

เอกสารสำคัญที่ต้องส่งให้คุณ:
• หนังสือรับรองดอกเบี้ย (สำหรับลดหย่อนภาษี)
• ใบแจ้งยอดรายไตรมาส
• ข้อมูลโปรโมชั่นและผลิตภัณฑ์ใหม่

โปรดให้ข้อมูลที่อยู่ใหม่หรือยืนยันที่อยู่ปัจจุบันด้วยครับ/คะ`
            },
            {
                id: 2,
                title: "ชวนคุยเรื่องโครงการคนละครึ่งพลัส",
                bullets: [
                    "STEP1: แนะนำโปรแกรมและประโยชน์: 'สวัสดีครับ/คะ คุณลูกค้า วันนี้มีข่าวดีเกี่ยวกับโครงการคนละครึ่งพลัสที่จะช่วยให้คุณประหยัดค่าใช้จ่ายในชีวิตประจำวันและยังได้รับสิทธิพิเศษจากทางธนาคาร'",
                    "STEP2: เชื่อมโยงกับผลิตภัณฑ์: 'เมื่อร่วมโครงการนี้ คุณยังสามารถสมัครบัตรเครดิตหรือสินเชื่อส่วนบุคคลที่มีอัตราดอกเบี้ยพิเศษ และได้รับเงินคืนเมื่อใช้จ่ายผ่านช่องทางที่กำหนด'"
                ],
                fullScript: `Counter Conversation 2: โครงการคนละครึ่งพลัส

STEP1:
"สวัสดีครับ/คะ คุณลูกค้า วันนี้มีข่าวดีเกี่ยวกับโครงการคนละครึ่งพลัสที่จะช่วยให้คุณประหยัดค่าใช้จ่ายในชีวิตประจำวันและยังได้รับสิทธิพิเศษจากทางธนาคาร"

STEP2:
"เมื่อร่วมโครงการนี้ คุณยังสามารถสมัครบัตรเครดิตหรือสินเชื่อส่วนบุคคลที่มีอัตราดอกเบี้ยพิเศษ และได้รับเงินคืนเมื่อใช้จ่ายผ่านช่องทางที่กำหนด"

สิทธิประโยชน์ในโครงการ:
• ส่วนสูงสุด 150 บาท/วัน (สูงสุด 1,500 บาท/เดือน)
• ส่วนลดเพิ่มจากร้านค้าพันธมิตร
• เงินคืน 5% เมื่อใช้บัตรเครดิตธนาคาร
• อัตราดอกเบี้ยพิเศษสำหรับสินเชื่อส่วนบุคคล

ลงทะเบียนง่ายๆ ผ่านแอปพลิเคชันธนาคาร ใช้เวลาเพียง 2 นาที`
            },
            {
                id: 3,
                title: "แนะนำเตรียมเอกสารลดหย่อนภาษีของ Easy e-Receipt",
                bullets: [
                    "STEP1: อธิบายความสะดวก: 'สวัสดีครับ/คะ คุณลูกค้า ด้วยนวัตกรรมใหม่ Easy e-Receipt จะช่วยให้คุณเก็บเอกสารลดหย่อนภาษีได้อย่างเป็นระบบและไม่ต้องกังวลว่าจะสูญหาย'",
                    "STEP2: สร้างแรงจูงใจ: 'เริ่มใช้บริการตั้งแต่ต้นปี จะได้บันทึกใบเสร็จทั้งหมดโดยอัตโนมัติ และเมื่อถึงเวลายื่นภาษี ระบบจะสรุปข้อมูลให้คุณอย่างครบถ้วน พร้อมคำแนะนำการลดหย่อนภาษี'"
                ],
                fullScript: `Counter Conversation 3: Easy e-Receipt

STEP1:
"สวัสดีครับ/คะ คุณลูกค้า ด้วยนวัตกรรมใหม่ Easy e-Receipt จะช่วยให้คุณเก็บเอกสารลดหย่อนภาษีได้อย่างเป็นระบบและไม่ต้องกังวลว่าจะสูญหาย"

STEP2:
"เริ่มใช้บริการตั้งแต่ต้นปี จะได้บันทึกใบเสร็จทั้งหมดโดยอัตโนมัติ และเมื่อถึงเวลายื่นภาษี ระบบจะสรุปข้อมูลให้คุณอย่างครบถ้วน พร้อมคำแนะนำการลดหย่อนภาษี"

คุณสมบัติเด่นของ Easy e-Receipt:
• บันทึกใบเสร็จอัตโนมัติผ่านแอปพลิเคชัน
• จัดหมวดหมู่ค่าใช้จ่ายสำหรับลดหย่อนภาษี
• แจ้งเตือนเมื่อใกล้ถึงวงเงินลดหย่อน
• สรุปรายงานภาษีอัตโนมัติ
• ปลอดภัยด้วยระบบ Cloud Storage

เริ่มใช้ฟรีตลอดปี และช่วยลดเวลายื่นภาษีได้ถึง 70%`
            },
            {
                id: 4,
                title: "ชวนคุยเรื่องภาษีดอกเบี้ยเงินฝาก",
                bullets: [
                    "STEP1: ระบุปัญหา: 'สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันอยากแชร์ข้อมูลสำคัญเกี่ยวกับภาษีดอกเบี้ยเงินฝากที่คุณอาจสามารถขอคืนได้หากมีเงื่อนไขที่เหมาะสม'",
                    "STEP2: เสนอทางแก้: 'เรามีบริการตรวจสอบและยื่นขอคืนภาษีดอกเบี้ยเงินฝากให้ โดยทีมงานจะวิเคราะห์ว่าคุณมีสิทธิ์ได้รับเงินคืนหรือไม่ และดำเนินการให้โดยไม่เสียค่าใช้จ่าย'"
                ],
                fullScript: `Counter Conversation 4: ภาษีดอกเบี้ยเงินฝาก

STEP1:
"สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันอยากแชร์ข้อมูลสำคัญเกี่ยวกับภาษีดอกเบี้ยเงินฝากที่คุณอาจสามารถขอคืนได้หากมีเงื่อนไขที่เหมาะสม"

STEP2:
"เรามีบริการตรวจสอบและยื่นขอคืนภาษีดอกเบี้ยเงินฝากให้ โดยทีมงานจะวิเคราะห์ว่าคุณมีสิทธิ์ได้รับเงินคืนหรือไม่ และดำเนินการให้โดยไม่เสียค่าใช้จ่าย"

เงื่อนไขที่อาจได้รับคืนภาษีดอกเบี้ย:
• รายได้ต่อปีต่ำกว่า 150,000 บาท
• มีค่าใช้จ่ายลดหย่อนอื่นๆ ที่สามารถนำมาหักได้
• เป็นผู้สูงอายุ (60 ปีขึ้นไป)
• มีบุคคลในครอบครัวที่อยู่ในความอุปการะ

บริการนี้ฟรีสำหรับลูกค้าธนาคาร และใช้เวลาเพียง 10-15 วันทำการ`
            },
            {
                id: 5,
                title: "ชวนคุยเรื่องการวางแผนภาษีสิ้นปี",
                bullets: [
                    "STEP1: สร้างความตระหนัก: 'สวัสดีครับ/คะ คุณลูกค้า ช่วงสิ้นปีนี้เป็นเวลาสำหรับการวางแผนภาษี ผม/ดิฉันเห็นว่าลูกค้าหลายคนเริ่มสอบถามเกี่ยวกับเรื่องนี้แล้ว คุณมีการเตรียมตัวหรือยังครับ/คะ'",
                    "STEP2: แสดงมูลค่าที่เสียไป: 'หากยังไม่มีการวางแผน อาจทำให้เสียโอกาสในการลดหย่อนภาษี ซึ่งภาษีปีหนึ่งมีมูลค่าประมาณเท่ากับเงินเดือน 1 เดือนเลยทีเดียว'"
                ],
                fullScript: `Counter Conversation 5: วางแผนภาษีสิ้นปี

STEP1:
"สวัสดีครับ/คะ คุณลูกค้า ช่วงสิ้นปีนี้เป็นเวลาสำหรับการวางแผนภาษี ผม/ดิฉันเห็นว่าลูกค้าหลายคนเริ่มสอบถามเกี่ยวกับเรื่องนี้แล้ว คุณมีการเตรียมตัวหรือยังครับ/คะ"

STEP2:
"หากยังไม่มีการวางแผน อาจทำให้เสียโอกาสในการลดหย่อนภาษี ซึ่งภาษีปีหนึ่งมีมูลค่าประมาณเท่ากับเงินเดือน 1 เดือนเลยทีเดียว"

บริการวางแผนภาษีฟรีจากธนาคาร:
• วิเคราะห์สถานการณ์ทางการเงินปัจจุบัน
• คำนวณภาษีโดยประมาณที่ต้องจ่าย
• แนะนำช่องทางลดหย่อนภาษีที่เหมาะสม
• ประเมินผลิตภัณฑ์การลงทุนสำหรับลดหย่อน

รีบตัดสินใจตอนนี้เพราะโปรโมชั่นสิ้นปีมีจำกัด และช่วยประหยัดเงินได้จริง!`
            }
        ];

        const defaultObjections = {
            call: [
                {
                    id: 1,
                    question: "เงินฝากปลอดภัยกว่า ไม่เสี่ยง",
                    answer: "เข้าใจดีครับ/คะ เรื่องความปลอดภัยเป็นสิ่งสำคัญ ผลิตภัณฑ์นี้มีการลงทุนในสินทรัพย์คุณภาพสูงและมีความเสี่ยงต่ำ ซึ่งให้ผลตอบแทนที่ดีกว่าเงินฝากโดยมีความผันผวนที่ต่ำ",
                    tone: "เข้าใจความรู้สึก + เปรียบเทียบให้เห็นภาพ"
                },
                {
                    id: 2,
                    question: "ไม่มีความรู้ในการลงทุน",
                    answer: "ไม่ต้องกังวลครับ/คะ เรามีทีมผู้เชี่ยวชาญที่พร้อมให้คำแนะนำและดูแลพอร์ตการลงทุนให้คุณอย่างใกล้ชิด รวมถึงมีบริการติดตามผลอย่างสม่ำเสมอ",
                    tone: "ปลอบใจ + เสนอความช่วยเหลือ"
                },
                {
                    id: 3,
                    question: "รอให้ตลาดฟื้นตัวก่อน",
                    answer: "การรอให้ตลาดฟื้นตัวโดยไม่ทำอะไรอาจทำให้เสียโอกาสในการซื้อสินทรัพย์คุณภาพในราคาต่ำ ซึ่งจะช่วยเพิ่มศักยภาพในการทำกำไรเมื่อตลาดฟื้นตัว",
                    tone: "ให้ข้อมูลที่เป็นประโยชน์ + มองการณ์ไกล"
                },
                {
                    id: 4,
                    question: "ไม่มีเงินพอจะลงทุน",
                    answer: "เข้าใจดีครับ/คะ เรามีแผนการลงทุนที่เริ่มต้นเพียง 1,000 บาทเท่านั้น ซึ่งถือว่าคุ้มค่ามากเมื่อเทียบกับโอกาสในการสร้างผลตอบแทนที่สูงกว่า",
                    tone: "เข้าใจความรู้สึก + เปรียบเทียบให้เห็นภาพ"
                },
                {
                    id: 5,
                    question: "ต้องการปรึกษาครอบครัวก่อน",
                    answer: "เป็นการตัดสินใจที่ดีครับ/คะ ที่จะปรึกษาครอบครัว ขออนุญาตส่งข้อมูลรายละเอียดผลิตภัณฑ์ให้พิจารณาร่วมกัน และถ้ามีข้อสงสัยเพิ่มเติม ติดต่อกลับมาได้ตลอดเวลานะครับ/คะ",
                    tone: "เห็นด้วย + เสนอความช่วยเหลือ"
                }
            ],
            counter: [
                {
                    id: 1,
                    question: "ไม่สะดวกให้ข้อมูลตอนนี้",
                    answer: "เข้าใจครับ/คะ สามารถอัพเดทข้อมูลผ่านช่องทางอื่นได้ เช่น แอปพลิเคชันธนาคาร หรือสาขาใกล้บ้าน เมื่อสะดวกครับ/คะ",
                    tone: "เห็นใจ + เสนอทางเลือก"
                },
                {
                    id: 2,
                    question: "ข้อมูลเดิมยังใช้ได้อยู่",
                    answer: "การอัพเดทข้อมูลให้เป็นปัจจุบันจะช่วยให้เราส่งเอกสารสำคัญ เช่น หนังสือรับรองดอกเบี้ยสำหรับใช้สิทธิลดหย่อนภาษี ได้อย่างถูกต้องและทันเวลา",
                    tone: "อธิบายประโยชน์ + สร้างความเข้าใจ"
                },
                {
                    id: 3,
                    question: "มีโปรแกรมคล้ายๆ กันแล้ว",
                    answer: "โครงการคนละครึ่งพลัสนี้พิเศษกว่าตรงที่รัฐบาลและธนาคารร่วมสนับสนุน ทำให้ได้ส่วนลดสูงกว่าและมีร้านค้าร่วมโครงการมากกว่า",
                    tone: "ชี้จุดแตกต่าง + เสนอมูลค่าเพิ่ม"
                },
                {
                    id: 4,
                    question: "ไม่มั่นใจเรื่องความปลอดภัยของข้อมูล",
                    answer: "ข้อมูลของคุณจะถูกเก็บรักษาอย่างปลอดภัยด้วยระบบการเข้ารหัสข้อมูลระดับสูง และปฏิบัติตามกฎหมายคุ้มครองข้อมูลส่วนบุคคลอย่างเคร่งครัด",
                    tone: "สร้างความมั่นใจ + อธิบายมาตรการ"
                },
                {
                    id: 5,
                    question: "ไม่ค่อยใช้บริการธนาคารบ่อย",
                    answer: "การอัพเดทข้อมูลเพียงครั้งเดียวจะช่วยให้คุณได้รับบริการที่ดียิ่งขึ้นในอนาคต และยังสามารถรับสิทธิประโยชน์พิเศษต่างๆ จากธนาคารได้อีกด้วย",
                    tone: "อธิบายประโยชน์ระยะยาว + สร้างแรงจูงใจ"
                }
            ],
            general: [
                {
                    id: 1,
                    question: "ไม่มีเงินพอจะซื้อประกัน",
                    answer: "เข้าใจดีครับ/คะ เรื่องเงินเป็นเรื่องสำคัญ เรามีแผนประกันที่เริ่มต้นเพียงวันละ 20 บาทเท่านั้น ซึ่งถือว่าคุ้มค่ามากเมื่อเทียบกับความคุ้มครองที่ได้รับ",
                    tone: "เข้าใจความรู้สึก + เปรียบเทียบให้เห็นภาพ"
                },
                {
                    id: 2,
                    question: "ยังไม่แน่ใจเกี่ยวกับผลตอบแทน",
                    answer: "ผลตอบแทนของผลิตภัณฑ์นี้มีการการันตีอย่างชัดเจน โดยจะได้รับคืนปีละ 4% ในปีที่ 1-9 และเมื่อครบ 10 ปีจะได้รับ 404% ของเงินเบี้ยประกัน ซึ่งเป็นอัตราที่สูงกว่าการฝากเงินทั่วไป",
                    tone: "ให้ข้อมูลที่เป็นประโยชน์ + มองการณ์ไกล"
                },
                {
                    id: 3,
                    question: "ต้องการปรึกษาครอบครัวก่อน",
                    answer: "เป็นการตัดสินใจที่ดีครับ/คะ ที่จะปรึกษาครอบครัว ขออนุญาตส่งข้อมูลรายละเอียดผลิตภัณฑ์ให้พิจารณาร่วมกัน และถ้ามีข้อสงสัยเพิ่มเติม ติดต่อกลับมาได้ตลอดเวลานะครับ/คะ",
                    tone: "เห็นด้วย + เสนอความช่วยเหลือ"
                },
                {
                    id: 4,
                    question: "อายุยังน้อย ไม่จำเป็นต้องทำประกัน",
                    answer: "การทำประกันตอนอายุน้อยกว่าเบี้ยจะถูกกว่าและได้รับความคุ้มครองเร็วขึ้น รวมถึงสามารถสะสมเงินก้อนได้ตั้งแต่เนิ่นๆ สำหรับใช้ในอนาคต",
                    tone: "ให้ข้อมูลที่เป็นประโยชน์ + มองการณ์ไกล"
                },
                {
                    id: 5,
                    question: "มีประกันจากที่ทำงานอยู่แล้ว",
                    answer: "ประกันจากที่ทำงานเป็นสิ่งที่ดี แต่การมีประกันส่วนตัวเพิ่มเติมจะช่วยเสริมความคุ้มครองให้สมบูรณ์ยิ่งขึ้น โดยเฉพาะเมื่อเปลี่ยนงานหรือเกษียณ",
                    tone: "เสริมจุดแข็ง + อธิบายประโยชน์เพิ่มเติม"
                }
            ]
        };

        // Data Management
        let isAdmin = false;
        let currentEditingId = null;

        // Initialize Data
        function initializeData() {
            if (!localStorage.getItem('callScripts')) {
                localStorage.setItem('callScripts', JSON.stringify(defaultCallScripts));
            }
            if (!localStorage.getItem('counterScripts')) {
                localStorage.setItem('counterScripts', JSON.stringify(defaultCounterScripts));
            }
            if (!localStorage.getItem('objections')) {
                localStorage.setItem('objections', JSON.stringify(defaultObjections));
            }
            if (!localStorage.getItem('uploadedFiles')) {
                localStorage.setItem('uploadedFiles', JSON.stringify([]));
            }
        }

        // Get Data
        function getCallScripts() {
            return JSON.parse(localStorage.getItem('callScripts')) || [];
        }

        function getCounterScripts() {
            return JSON.parse(localStorage.getItem('counterScripts')) || [];
        }

        function getObjections() {
            return JSON.parse(localStorage.getItem('objections')) || {};
        }

        function getUploadedFiles() {
            return JSON.parse(localStorage.getItem('uploadedFiles')) || [];
        }

        // Save Data
        function saveCallScripts(scripts) {
            localStorage.setItem('callScripts', JSON.stringify(scripts));
        }

        function saveCounterScripts(scripts) {
            localStorage.setItem('counterScripts', JSON.stringify(scripts));
        }

        function saveObjections(objections) {
            localStorage.setItem('objections', JSON.stringify(objections));
        }

        function saveUploadedFiles(files) {
            localStorage.setItem('uploadedFiles', JSON.stringify(files));
        }

        // Check Admin Status
        function checkAdminStatus() {
            const adminStatus = localStorage.getItem('isAdmin');
            isAdmin = adminStatus === 'true';
            
            // แสดงหรือซ่อน Admin Controls ตามสถานะ
            const adminControls = document.getElementById('adminControls');
            if (isAdmin && adminControls) {
                adminControls.classList.add('active');
            } else if (adminControls) {
                adminControls.classList.remove('active');
            }
        }

        // Start Application
        function startApp() {
            const loadingScreen = document.getElementById('loadingScreen');
            const mainApp = document.getElementById('mainApp');
            
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
                loadingScreen.style.display = 'none';
                mainApp.style.display = 'block';
                initializeData();
                checkAdminStatus(); // ตรวจสอบสถานะแอดมิน
                setupNavigation();
                loadHomePage();
            }, 500);
        }

        // Navigation
        function setupNavigation() {
            // Nav bar items
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.onclick) return; // Skip items with existing click handlers
                
                item.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    if (pageId) {
                        showPage(pageId);
                    }
                });
            });
            
            // Quick access items
            document.querySelectorAll('.quick-item').forEach(item => {
                item.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    showPage(pageId);
                });
            });
        }

        // Show Page
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page and add active class to nav item
            document.getElementById(pageId).classList.add('active');
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // Load page content
            switch(pageId) {
                case 'home':
                    loadHomePage();
                    break;
                case 'scripts':
                    loadScriptsPage();
                    break;
                case 'script-designer':
                    loadScriptDesignerPage();
                    break;
                case 'objection-handling':
                    loadObjectionHandlingPage();
                    break;
                case 'conversation-builder':
                    loadConversationBuilderPage();
                    break;
                case 'techniques':
                    loadTechniquesPage();
                    break;
                case 'tools':
                    loadToolsPage();
                    break;
            }
        }

        // Load Home Page
        function loadHomePage() {
            // Load statistics
            const statsGrid = document.getElementById('statsGrid');
            if (statsGrid) {
                const callScripts = getCallScripts();
                const counterScripts = getCounterScripts();
                const objections = getObjections();
                
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-value">${callScripts.length}</div>
                        <div class="stat-label">Call Scripts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${counterScripts.length}</div>
                        <div class="stat-label">Counter Scripts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${Object.values(objections).flat().length}</div>
                        <div class="stat-label">ข้อโต้แย้ง</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">5</div>
                        <div class="stat-label">เทคนิค</div>
                    </div>
                `;
            }
            
            // Update quick access items with counts
            const quickItems = document.querySelectorAll('.quick-item');
            if (quickItems.length >= 4) {
                const callScripts = getCallScripts();
                const counterScripts = getCounterScripts();
                const objections = getObjections();
                
                quickItems[0].querySelector('p').textContent = `จัดการสคริปต์การโทรทั้งหมด (${callScripts.length + counterScripts.length} สคริปต์)`;
                quickItems[1].querySelector('p').textContent = `สร้างสคริปต์แบบ Customize`;
                quickItems[2].querySelector('p').textContent = `เทคนิคการตอบคำถามลูกค้า (${Object.values(objections).flat().length} ข้อโต้แย้ง)`;
                quickItems[3].querySelector('p').textContent = `สร้างบทสนทนาแบบไดนามิก`;
            }
        }

        // Load Scripts Page
        function loadScriptsPage() {
            loadCallScripts();
            
            // Setup script tabs
            document.querySelectorAll('.script-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    
                    // Update active tab
                    document.querySelectorAll('.script-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.script-tab-content').forEach(content => {
                        content.style.display = 'none';
                    });
                    
                    if (type === 'call') {
                        document.getElementById('callScripts').style.display = 'block';
                        loadCallScripts();
                    } else {
                        document.getElementById('counterScripts').style.display = 'block';
                        loadCounterScripts();
                    }
                });
            });
        }

        // Load Call Scripts
        function loadCallScripts() {
            const container = document.getElementById('callScriptsList');
            if (!container) return;
            
            container.innerHTML = '';
            const scripts = getCallScripts();
            
            if (scripts.length === 0) {
                container.innerHTML = '<p>ยังไม่มีสคริปต์ Call Scripts</p>';
                return;
            }
            
            scripts.forEach(script => {
                const card = document.createElement('div');
                card.className = 'script-card';
                
                // ใช้ checkAdminStatus() เพื่อตรวจสอบสถานะปัจจุบัน
                const adminButtons = isAdmin ? `
                <div class="admin-buttons" style="margin-top: 1rem;">
                    <button class="admin-btn" onclick="editScript(${script.id}, 'call')">แก้ไข</button>
                    <button class="admin-btn delete" onclick="deleteScript(${script.id}, 'call')">ลบ</button>
                </div>
                ` : '';
                
                card.innerHTML = `
                    <h3>${script.title}</h3>
                    <div class="script-content">
                        <ul class="script-bullets">
                            ${script.bullets.map(bullet => `<li>${bullet}</li>`).join('')}
                        </ul>
                        <div class="full-script" id="fullScript-${script.id}">
                            <strong>สคริปต์เต็ม:</strong>
                            <pre>${script.fullScript}</pre>
                        </div>
                        <button class="nav-item" onclick="toggleFullScript(${script.id})" style="margin-top: 0.5rem; padding: 0.5rem 1rem; font-size: 0.8rem;">
                            แสดงสคริปต์เต็ม
                        </button>
                        ${adminButtons}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Load Counter Scripts
        function loadCounterScripts() {
            const container = document.getElementById('counterScriptsList');
            if (!container) return;
            
            container.innerHTML = '';
            const scripts = getCounterScripts();
            
            if (scripts.length === 0) {
                container.innerHTML = '<p>ยังไม่มีสคริปต์ Counter Conversation</p>';
                return;
            }
            
            scripts.forEach(script => {
                const card = document.createElement('div');
                card.className = 'script-card';
                
                // ใช้ checkAdminStatus() เพื่อตรวจสอบสถานะปัจจุบัน
                const adminButtons = isAdmin ? `
                <div class="admin-buttons" style="margin-top: 1rem;">
                    <button class="admin-btn" onclick="editScript(${script.id}, 'counter')">แก้ไข</button>
                    <button class="admin-btn delete" onclick="deleteScript(${script.id}, 'counter')">ลบ</button>
                </div>
                ` : '';
                
                card.innerHTML = `
                    <h3>${script.title}</h3>
                    <div class="script-content">
                        <ul class="script-bullets">
                            ${script.bullets.map(bullet => `<li>${bullet}</li>`).join('')}
                        </ul>
                        <div class="full-script" id="fullScript-counter-${script.id}">
                            <strong>สคริปต์เต็ม:</strong>
                            <pre>${script.fullScript}</pre>
                        </div>
                        <button class="nav-item" onclick="toggleFullScript('counter-${script.id}')" style="margin-top: 0.5rem; padding: 0.5rem 1rem; font-size: 0.8rem;">
                            แสดงสคริปต์เต็ม
                        </button>
                        ${adminButtons}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Toggle Full Script
        function toggleFullScript(scriptId) {
            // Hide all full scripts first
            document.querySelectorAll('.full-script').forEach(script => {
                script.style.display = 'none';
            });
            
            // Reset all buttons
            document.querySelectorAll('.nav-item').forEach(button => {
                if (button.textContent === 'ซ่อนสคริปต์เต็ม') {
                    button.textContent = 'แสดงสคริปต์เต็ม';
                }
            });
            
            const fullScript = document.getElementById(`fullScript-${scriptId}`);
            const button = event.target;
            
            if (fullScript.style.display === 'block') {
                fullScript.style.display = 'none';
                button.textContent = 'แสดงสคริปต์เต็ม';
            } else {
                fullScript.style.display = 'block';
                button.textContent = 'ซ่อนสคริปต์เต็ม';
            }
        }

        // Load Objection Handling Page
        function loadObjectionHandlingPage() {
            loadObjections('call');
            
            // Setup category tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    
                    // Update active tab
                    document.querySelectorAll('.category-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Load objections for this category
                    loadObjections(category);
                });
            });
        }

        // Load Objections by Category
        function loadObjections(category) {
            const container = document.getElementById('objectionList');
            if (!container) return;
            
            container.innerHTML = '';
            const objections = getObjections();
            
            if (objections[category] && objections[category].length > 0) {
                objections[category].forEach(obj => {
                    const item = document.createElement('div');
                    item.className = 'objection-item';
                    
                    // ใช้ checkAdminStatus() เพื่อตรวจสอบสถานะปัจจุบัน
                    const adminButtons = isAdmin ? `
                    <div class="admin-buttons" style="margin-top: 1rem;">
                        <button class="admin-btn" onclick="editObjection(${obj.id}, '${category}')">แก้ไข</button>
                        <button class="admin-btn delete" onclick="deleteObjection(${obj.id}, '${category}')">ลบ</button>
                    </div>
                    ` : '';
                    
                    item.innerHTML = `
                        <div class="objection-question" onclick="toggleAnswer(this)">
                            ${obj.question}
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="objection-answer">${obj.answer}</div>
                        <div class="objection-tone">โทนเสียง: ${obj.tone}</div>
                        ${adminButtons}
                    `;
                    container.appendChild(item);
                });
            } else {
                container.innerHTML = '<p>ยังไม่มีข้อโต้แย้งในหมวดหมู่นี้</p>';
            }
        }

        // Toggle Answer Visibility
        function toggleAnswer(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('i');
            
            if (answer.style.display === 'block') {
                answer.style.display = 'none';
                icon.className = 'fas fa-chevron-down';
            } else {
                answer.style.display = 'block';
                icon.className = 'fas fa-chevron-up';
            }
        }

        // Load Script Designer Page
        function loadScriptDesignerPage() {
            // Load default components
            loadScriptComponents();
            
            // Setup script tabs
            document.querySelectorAll('.script-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const templateType = this.getAttribute('data-template');
                    
                    // Update active tab
                    document.querySelectorAll('.script-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show corresponding content
                    if (templateType === 'custom') {
                        document.getElementById('customDesigner').style.display = 'grid';
                        document.getElementById('templateDesigner').style.display = 'none';
                    } else {
                        document.getElementById('customDesigner').style.display = 'none';
                        document.getElementById('templateDesigner').style.display = 'block';
                    }
                });
            });
        }

        // Load Script Components
        function loadScriptComponents() {
            // Default components
            const components = {
                opening: [
                    {
                        id: 1,
                        title: "ทักทายลูกค้า",
                        content: "สวัสดีครับ/คะ คุณ{ชื่อลูกค้า} ผม/ดิฉัน{ชื่อพนักงาน} จาก{ชื่อบริษัท} วันนี้โทรมาเพื่อ{วัตถุประสงค์}ครับ/ค่ะ"
                    },
                    {
                        id: 2,
                        title: "เปิดบทสนทนาแบบเป็นกันเอง",
                        content: "สวัสดีครับ/คะ คุณ{ชื่อลูกค้า} ไม่ทราบว่าตอนนี้สะดวกคุยไหมครับ/คะ?"
                    }
                ],
                painPoint: [
                    {
                        id: 1,
                        title: "ปัญหาเงินนิ่ง",
                        content: "ผม/ดิฉันเห็นว่าบัญชีเงินฝากของคุณมียอดคงเหลือค่อนข้างสูง ซึ่งดอกเบี้ยเงินฝากในปัจจุบันต่ำมาก ทำให้เงินฝากเติบโตช้าและอาจไม่ชนะอัตราเงินเฟ้อ"
                    },
                    {
                        id: 2,
                        title: "ปัญหาเงินฝากประจำใกล้ครบ",
                        content: "เห็นว่าบัญชีเงินฝากประจำของคุณกำลังจะครบกำหนดในอีก {X} วัน การต่ออายุอัตโนมัติอาจทำให้พลาดโอกาสลงทุนที่ให้ผลตอบแทนดีกว่า"
                    }
                ],
                solution: [
                    {
                        id: 1,
                        title: "เสนอผลิตภัณฑ์ลงทุน",
                        content: "เรามีผลิตภัณฑ์การลงทุนที่เหมาะสมกับคุณ ซึ่งให้ผลตอบแทน{X}% ต่อปี สูงกว่าดอกเบี้ยเงินฝากทั่วไป"
                    },
                    {
                        id: 2,
                        title: "เสนอประกันชีวิต",
                        content: "เรามีแผนประกันชีวิตที่ช่วยลดหย่อนภาษีได้สูงสุด {X} บาท และยังได้รับความคุ้มครองชีวิตอีกด้วย"
                    }
                ],
                closing: [
                    {
                        id: 1,
                        title: "ปิดการขายแบบนุ่มนวล",
                        content: "ไม่ทราบว่าคุณ{ชื่อลูกค้า} สนใจทราบรายละเอียดเพิ่มเติมไหมครับ/คะ?"
                    },
                    {
                        id: 2,
                        title: "ปิดการขายแบบเร่งด่วน",
                        content: "โปรโมชั่นนี้มีจำกัดเพียง {X} รายแรกเท่านั้น คุณ{ชื่อลูกค้า} สนใจลงทะเบียนเลยไหมครับ/คะ?"
                    }
                ],
                special: [
                    {
                        id: 1,
                        title: "ประโยคสร้างความมั่นใจ",
                        content: "ลูกค้าหลายท่านที่ใช้บริการนี้มีความพึงพอใจสูงและได้รับผลตอบแทนตามที่คาดหวัง"
                    },
                    {
                        id: 2,
                        title: "ประโยคกระตุ้นการตัดสินใจ",
                        content: "ยิ่งเริ่มต้นเร็ว ยิ่งได้รับผลตอบแทนที่มากขึ้นในระยะยาว"
                    }
                ]
            };
            
            // Load opening components
            const openingContainer = document.getElementById('openingComponents');
            openingContainer.innerHTML = '';
            components.opening.forEach(component => {
                const item = createComponentItem(component, 'opening');
                openingContainer.appendChild(item);
            });
            
            // Load pain point components
            const painPointContainer = document.getElementById('painPointComponents');
            painPointContainer.innerHTML = '';
            components.painPoint.forEach(component => {
                const item = createComponentItem(component, 'painPoint');
                painPointContainer.appendChild(item);
            });
            
            // Load solution components
            const solutionContainer = document.getElementById('solutionComponents');
            solutionContainer.innerHTML = '';
            components.solution.forEach(component => {
                const item = createComponentItem(component, 'solution');
                solutionContainer.appendChild(item);
            });
            
            // Load closing components
            const closingContainer = document.getElementById('closingComponents');
            closingContainer.innerHTML = '';
            components.closing.forEach(component => {
                const item = createComponentItem(component, 'closing');
                closingContainer.appendChild(item);
            });
            
            // Load special components
            const specialContainer = document.getElementById('specialComponents');
            specialContainer.innerHTML = '';
            components.special.forEach(component => {
                const item = createComponentItem(component, 'special');
                specialContainer.appendChild(item);
            });
        }

        // Create Component Item
        function createComponentItem(component, category) {
            const item = document.createElement('div');
            item.className = 'component-item';
            item.setAttribute('data-id', component.id);
            item.setAttribute('data-category', category);
            
            item.innerHTML = `
                <strong>${component.title}</strong>
                <div class="component-content">${component.content}</div>
            `;
            
            // Add click event to add component to script
            item.addEventListener('click', function() {
                // Remove selected class from all components
                document.querySelectorAll('.component-item').forEach(el => {
                    el.classList.remove('selected');
                });
                
                // Add selected class to clicked component
                this.classList.add('selected');
                
                // Add component to script
                addComponentToScript(component, category);
            });
            
            return item;
        }

        // Add Component to Script
        function addComponentToScript(component, category) {
            const scriptStructure = document.getElementById('scriptStructure');
            
            // Remove empty message if exists
            const emptySection = scriptStructure.querySelector('.empty-section');
            if (emptySection) {
                emptySection.remove();
            }
            
            const section = document.createElement('div');
            section.className = 'structure-section';
            section.setAttribute('data-id', component.id);
            section.setAttribute('data-category', category);
            
            section.innerHTML = `
                <div class="section-header">
                    <div class="section-title">${component.title}</div>
                    <button class="admin-btn delete" onclick="removeComponent(this)">ลบ</button>
                </div>
                <div class="section-content">${component.content}</div>
            `;
            
            scriptStructure.appendChild(section);
        }

        // Remove Component
        function removeComponent(button) {
            const section = button.closest('.structure-section');
            section.remove();
            
            // Show empty message if no components left
            const scriptStructure = document.getElementById('scriptStructure');
            if (scriptStructure.children.length === 0) {
                scriptStructure.innerHTML = '<div class="empty-section">เลือกส่วนประกอบจากด้านซ้ายเพื่อสร้างสคริปต์</div>';
            }
        }

        // Clear Script Design
        function clearScriptDesign() {
            if (confirm('คุณแน่ใจว่าต้องการล้างสคริปต์ทั้งหมด?')) {
                const scriptStructure = document.getElementById('scriptStructure');
                scriptStructure.innerHTML = '<div class="empty-section">เลือกส่วนประกอบจากด้านซ้ายเพื่อสร้างสคริปต์</div>';
                
                // Remove selected class from all components
                document.querySelectorAll('.component-item').forEach(el => {
                    el.classList.remove('selected');
                });
            }
        }

        // Save Designed Script
        function saveDesignedScript() {
            const scriptStructure = document.getElementById('scriptStructure');
            const sections = scriptStructure.querySelectorAll('.structure-section');
            
            if (sections.length === 0) {
                alert('กรุณาเพิ่มส่วนประกอบในสคริปต์ก่อนบันทึก');
                return;
            }
            
            const title = prompt('กรุณาใส่ชื่อสคริปต์:');
            if (!title) return;
            
            const scriptType = prompt('เลือกประเภทสคริปต์ (call หรือ counter):', 'call');
            if (!scriptType) return;
            
            // Build script content
            let fullScript = '';
            const bullets = [];
            
            sections.forEach(section => {
                const content = section.querySelector('.section-content').textContent;
                fullScript += content + '\n\n';
                bullets.push(content.substring(0, 100) + '...');
            });
            
            // Save to appropriate storage
            let scripts;
            if (scriptType === 'call') {
                scripts = getCallScripts();
            } else {
                scripts = getCounterScripts();
            }
            
            const newId = scripts.length > 0 ? Math.max(...scripts.map(s => s.id)) + 1 : 1;
            
            const newScript = {
                id: newId,
                title: title,
                bullets: bullets,
                fullScript: fullScript
            };
            
            scripts.push(newScript);
            
            if (scriptType === 'call') {
                saveCallScripts(scripts);
            } else {
                saveCounterScripts(scripts);
            }
            
            alert('บันทึกสคริปต์สำเร็จ!');
            showPage('scripts');
        }

        // Export Script
        function exportScript() {
            const scriptStructure = document.getElementById('scriptStructure');
            const sections = scriptStructure.querySelectorAll('.structure-section');
            
            if (sections.length === 0) {
                alert('ไม่มีสคริปต์ที่จะส่งออก');
                return;
            }
            
            let scriptText = '';
            
            sections.forEach(section => {
                const title = section.querySelector('.section-title').textContent;
                const content = section.querySelector('.section-content').textContent;
                scriptText += `[${title}]\n${content}\n\n`;
            });
            
            // Create download link
            const blob = new Blob([scriptText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'สคริปต์ที่ออกแบบ.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('ส่งออกสคริปต์เรียบร้อยแล้ว!');
        }

        // Load Techniques Page
        function loadTechniquesPage() {
            const container = document.getElementById('techniqueList');
            if (!container) return;
            
            container.innerHTML = `
                <div class="technique-item">
                    <div class="technique-header">
                        <div class="technique-title">เทคนิคการฟังอย่าง aktif</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="technique-details">
                        การฟังอย่างตั้งใจและแสดงออกว่ากำลังฟังอยู่ เช่น การใช้คำพูดเช่น 'ครับ/ค่ะ', 'เข้าใจแล้วครับ/ค่ะ' เพื่อสร้างความมั่นใจให้ลูกค้า และการสรุปสิ่งที่ลูกค้าพูดเพื่อยืนยันความเข้าใจ
                    </div>
                </div>
                <div class="technique-item">
                    <div class="technique-header">
                        <div class="technique-title">เทคนิคการตั้งคำถามปลายเปิด</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="technique-details">
                        ใช้คำถามปลายเปิดเพื่อให้ลูกค้าได้พูดมากขึ้น เช่น 'ลูกค้ามีความคิดเห็นอย่างไรบ้างครับ/คะ?' หรือ 'มีอะไรที่เราช่วยได้เพิ่มเติมไหมคะ/ครับ?' เพื่อดึงข้อมูลและความต้องการที่แท้จริง
                    </div>
                </div>
                <div class="technique-item">
                    <div class="technique-header">
                        <div class="technique-title">เทคนิค Mirroring</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="technique-details">
                        สะท้อนคำพูดหรือความรู้สึกของลูกค้าเพื่อสร้างความเข้าใจ เช่น เมื่อลูกค้าบอก 'ไม่มีเวลา' เราตอบ 'เข้าใจค่ะ/ครับว่าคุณไม่มีเวลา' เพื่อสร้างความเป็นหนึ่งเดียวและความไว้วางใจ
                    </div>
                </div>
            `;
            
            // Add toggle functionality
            document.querySelectorAll('.technique-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // Only toggle details if not clicking admin buttons
                    if (!e.target.classList.contains('admin-btn')) {
                        const details = this.querySelector('.technique-details');
                        const icon = this.querySelector('i');
                        
                        if (details.style.display === 'block') {
                            details.style.display = 'none';
                            icon.className = 'fas fa-chevron-down';
                        } else {
                            details.style.display = 'block';
                            icon.className = 'fas fa-chevron-up';
                        }
                    }
                });
            });
        }

        // Load Tools Page
        function loadToolsPage() {
            const container = document.getElementById('toolsList');
            if (!container) return;
            
            container.innerHTML = `
                <div class="tool-item">
                    <i class="fas fa-file-pdf"></i>
                    <h4>คู่มือการขาย</h4>
                    <p>PDF</p>
                </div>
                <div class="tool-item">
                    <i class="fas fa-image"></i>
                    <h4>ภาพโปรโมชั่น</h4>
                    <p>IMAGE</p>
                </div>
                <div class="tool-item">
                    <i class="fas fa-file-excel"></i>
                    <h4>ตารางงาน</h4>
                    <p>EXCEL</p>
                </div>
                <div class="tool-item">
                    <i class="fas fa-video"></i>
                    <h4>วิดีโอเทรนนิ่ง</h4>
                    <p>VIDEO</p>
                </div>
            `;
        }

        // Load Uploaded Files
        function loadUploadedFiles() {
            const container = document.getElementById('fileList');
            if (!container) return;
            
            container.innerHTML = '';
            const files = getUploadedFiles();
            
            if (files.length === 0) {
                container.innerHTML = '<p>ยังไม่มีไฟล์ที่อัพโหลด</p>';
                return;
            }
            
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span>${file.name}</span>
                    <div class="admin-buttons">
                        <button class="admin-btn" onclick="downloadFile('${file.name}')">ดาวน์โหลด</button>
                        <button class="admin-btn delete" onclick="deleteFile('${file.name}')">ลบ</button>
                    </div>
                `;
                container.appendChild(fileItem);
            });
        }

        // Upload Files
        function uploadFiles() {
            const fileInput = document.getElementById('fileUpload');
            const files = fileInput.files;
            
            if (files.length === 0) {
                alert('กรุณาเลือกไฟล์ก่อนอัพโหลด');
                return;
            }
            
            const uploadedFiles = getUploadedFiles();
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                uploadedFiles.push({
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    lastModified: file.lastModified
                });
            }
            
            saveUploadedFiles(uploadedFiles);
            loadUploadedFiles();
            alert(`อัพโหลดไฟล์ ${files.length} ไฟล์เรียบร้อยแล้ว!`);
            
            // Reset file input
            fileInput.value = '';
        }

        // Download File
        function downloadFile(fileName) {
            alert(`ดาวน์โหลดไฟล์: ${fileName}`);
            // ในระบบจริงควรมีโค้ดสำหรับดาวน์โหลดไฟล์
        }

        // Delete File
        function deleteFile(fileName) {
            if (!confirm(`คุณแน่ใจว่าต้องการลบไฟล์ "${fileName}"?`)) return;
            
            const uploadedFiles = getUploadedFiles();
            const updatedFiles = uploadedFiles.filter(file => file.name !== fileName);
            saveUploadedFiles(updatedFiles);
            loadUploadedFiles();
            alert('ลบไฟล์เรียบร้อยแล้ว!');
        }

        // Admin Functions
        function showAdminControls() {
            const adminControls = document.getElementById('adminControls');
            adminControls.classList.add('active');
            isAdmin = true;
            localStorage.setItem('isAdmin', 'true');
            
            // Load uploaded files when showing admin controls
            loadUploadedFiles();
            
            // Reload all pages to show admin controls
            const currentPage = document.querySelector('.page.active').id;
            showPage(currentPage);
        }

        function hideAdminControls() {
            const adminControls = document.getElementById('adminControls');
            adminControls.classList.remove('active');
            isAdmin = false;
            localStorage.setItem('isAdmin', 'false');
            
            // Reload all pages to hide admin controls
            const currentPage = document.querySelector('.page.active').id;
            showPage(currentPage);
        }

        // ออกจากระบบแอดมิน
        function logoutAdmin() {
            if (confirm("คุณแน่ใจว่าต้องการออกจากระบบแอดมิน?")) {
                hideAdminControls();
                alert("ออกจากระบบแอดมินเรียบร้อยแล้ว");
            }
        }

        // Admin Modal Functions
        function showAdminModal() {
            document.getElementById('adminModal').style.display = 'flex';
        }

        function closeAdminModal() {
            document.getElementById('adminModal').style.display = 'none';
            document.getElementById('adminPasscode').value = '';
        }

        function checkAdminPasscode() {
            const passcode = document.getElementById('adminPasscode').value;
            if (passcode === '2025') {
                showAdminControls();
                closeAdminModal();
                alert('เข้าสู่ระบบแอดมินสำเร็จ!');
            } else {
                alert('รหัสผ่านไม่ถูกต้อง');
                document.getElementById('adminPasscode').value = '';
            }
        }

        // Add Script Functions
        function showAddScriptModal() {
            document.getElementById('addScriptModal').style.display = 'flex';
            currentEditingId = null;
            document.getElementById('scriptTitle').value = '';
            document.getElementById('scriptBullets').value = '';
            document.getElementById('scriptFull').value = '';
        }

        function closeAddScriptModal() {
            document.getElementById('addScriptModal').style.display = 'none';
        }

        function addNewScript() {
            const type = document.getElementById('scriptType').value;
            const title = document.getElementById('scriptTitle').value;
            const bullets = document.getElementById('scriptBullets').value.split('\n').filter(b => b.trim() !== '');
            const fullScript = document.getElementById('scriptFull').value;
            
            if (!title || bullets.length === 0 || !fullScript) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }
            
            let scripts;
            if (type === 'call') {
                scripts = getCallScripts();
            } else {
                scripts = getCounterScripts();
            }
            
            const newId = scripts.length > 0 ? Math.max(...scripts.map(s => s.id)) + 1 : 1;
            
            const newScript = {
                id: newId,
                title,
                bullets,
                fullScript
            };
            
            scripts.push(newScript);
            
            if (type === 'call') {
                saveCallScripts(scripts);
            } else {
                saveCounterScripts(scripts);
            }
            
            closeAddScriptModal();
            loadScriptsPage();
            alert('เพิ่มสคริปต์สำเร็จ!');
        }

        function editScript(id, type) {
            let scripts;
            if (type === 'call') {
                scripts = getCallScripts();
            } else {
                scripts = getCounterScripts();
            }
            
            const script = scripts.find(s => s.id === id);
            if (!script) return;
            
            document.getElementById('scriptType').value = type;
            document.getElementById('scriptTitle').value = script.title;
            document.getElementById('scriptBullets').value = script.bullets.join('\n');
            document.getElementById('scriptFull').value = script.fullScript;
            
            currentEditingId = id;
            document.getElementById('addScriptModal').style.display = 'flex';
        }

        function deleteScript(id, type) {
            if (!confirm('คุณแน่ใจว่าต้องการลบสคริปต์นี้?')) return;
            
            let scripts;
            if (type === 'call') {
                scripts = getCallScripts();
                scripts = scripts.filter(s => s.id !== id);
                saveCallScripts(scripts);
            } else {
                scripts = getCounterScripts();
                scripts = scripts.filter(s => s.id !== id);
                saveCounterScripts(scripts);
            }
            
            loadScriptsPage();
            alert('ลบสคริปต์สำเร็จ!');
        }

        // Add Objection Functions
        function showAddObjectionModal() {
            document.getElementById('addObjectionModal').style.display = 'flex';
            currentEditingId = null;
            document.getElementById('objectionQuestion').value = '';
            document.getElementById('objectionAnswer').value = '';
            document.getElementById('objectionTone').value = '';
        }

        function closeAddObjectionModal() {
            document.getElementById('addObjectionModal').style.display = 'none';
        }

        function addNewObjection() {
            const category = document.getElementById('objectionCategory').value;
            const question = document.getElementById('objectionQuestion').value;
            const answer = document.getElementById('objectionAnswer').value;
            const tone = document.getElementById('objectionTone').value;
            
            if (!question || !answer || !tone) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }
            
            const objections = getObjections();
            if (!objections[category]) {
                objections[category] = [];
            }
            
            const newId = objections[category].length > 0 ? Math.max(...objections[category].map(o => o.id)) + 1 : 1;
            
            const newObjection = {
                id: newId,
                question,
                answer,
                tone
            };
            
            objections[category].push(newObjection);
            saveObjections(objections);
            
            closeAddObjectionModal();
            loadObjectionHandlingPage();
            alert('เพิ่มข้อโต้แย้งสำเร็จ!');
        }

        function editObjection(id, category) {
            const objections = getObjections();
            const objection = objections[category].find(o => o.id === id);
            if (!objection) return;
            
            document.getElementById('objectionCategory').value = category;
            document.getElementById('objectionQuestion').value = objection.question;
            document.getElementById('objectionAnswer').value = objection.answer;
            document.getElementById('objectionTone').value = objection.tone;
            
            currentEditingId = id;
            document.getElementById('addObjectionModal').style.display = 'flex';
        }

        function deleteObjection(id, category) {
            if (!confirm('คุณแน่ใจว่าต้องการลบข้อโต้แย้งนี้?')) return;
            
            const objections = getObjections();
            objections[category] = objections[category].filter(o => o.id !== id);
            saveObjections(objections);
            
            loadObjectionHandlingPage();
            alert('ลบข้อโต้แย้งสำเร็จ!');
        }

        // Clear All Data
        function clearAllData() {
            if (!confirm('คุณแน่ใจว่าต้องการล้างข้อมูลทั้งหมด? การกระทำนี้ไม่สามารถย้อนกลับได้!')) return;
            
            localStorage.removeItem('callScripts');
            localStorage.removeItem('counterScripts');
            localStorage.removeItem('objections');
            localStorage.removeItem('uploadedFiles');
            localStorage.removeItem('isAdmin');
            
            initializeData();
            checkAdminStatus();
            
            // Reload current page
            const currentPage = document.querySelector('.page.active').id;
            showPage(currentPage);
            
            alert('ล้างข้อมูลทั้งหมดสำเร็จ! ระบบได้โหลดข้อมูลเริ่มต้นใหม่');
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modals = ['adminModal', 'addScriptModal', 'addObjectionModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Auto start after 5 seconds if user doesn't click
            setTimeout(() => {
                if (document.getElementById('loadingScreen').style.display !== 'none') {
                    startApp();
                }
            }, 5000);
        });
    </script>
</body>
</html>
