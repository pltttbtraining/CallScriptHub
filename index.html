<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจัดการสคริปต์และข้อโต้แย้ง</title>
    <style>
        :root {
            --primary-blue: #e6f2ff;
            --secondary-blue: #cce5ff;
            --accent-blue: #99ccff;
            --glass-effect: rgba(255, 255, 255, 0.25);
            --shadow-light: 0 8px 32px rgba(0, 123, 255, 0.1);
            --dark-blue: #0066cc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e6f2ff 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--glass-effect);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite linear;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--dark-blue);
        }
        
        .admin-controls {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: var(--accent-blue);
            color: var(--dark-blue);
        }
        
        .btn-primary:hover {
            background-color: #80bfff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 102, 204, 0.2);
        }
        
        .btn-logout {
            background-color: #ffcccc;
            color: #cc0000;
        }
        
        .btn-logout:hover {
            background-color: #ff9999;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(204, 0, 0, 0.2);
        }
        
        .btn-danger {
            background-color: #ffcccc;
            color: #cc0000;
        }
        
        .btn-danger:hover {
            background-color: #ff9999;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .panel {
            background: var(--glass-effect);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            position: relative;
            overflow: hidden;
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: rotate(45deg);
            animation: shimmer 4s infinite linear;
        }
        
        .panel-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--dark-blue);
            font-weight: 600;
            position: relative;
            z-index: 1;
        }
        
        .script-tabs {
            display: flex;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .tab {
            padding: 10px 20px;
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .tab.active {
            background-color: var(--secondary-blue);
            color: var(--dark-blue);
        }
        
        .tab:hover:not(.active) {
            background-color: rgba(255, 255, 255, 0.9);
        }
        
        .script-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .script-item {
            padding: 12px;
            margin-bottom: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .script-item:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }
        
        .script-item.active {
            background-color: var(--secondary-blue);
            border-left: 4px solid var(--dark-blue);
        }
        
        .script-actions {
            display: flex;
            gap: 5px;
        }
        
        .script-content {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            min-height: 200px;
            white-space: pre-line;
            position: relative;
            z-index: 1;
            line-height: 1.6;
        }
        
        .script-step {
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 3px solid var(--accent-blue);
        }
        
        .step-title {
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 5px;
        }
        
        .argument-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .argument-item {
            padding: 12px;
            margin-bottom: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .argument-item:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }
        
        .argument-actions {
            display: flex;
            gap: 5px;
        }
        
        .argument-response {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            min-height: 150px;
            white-space: pre-line;
            position: relative;
            z-index: 1;
            line-height: 1.6;
        }
        
        .upload-section {
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }
        
        .file-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px dashed #99ccff;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.7);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #99ccff;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.7);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .hidden {
            display: none;
        }
        
        .conversation-node {
            margin: 10px 0;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            border-left: 3px solid var(--accent-blue);
        }
        
        .node-options {
            margin-top: 10px;
            padding-left: 20px;
        }
        
        .node-option {
            padding: 8px;
            margin: 5px 0;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .node-option:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ระบบจัดการสคริปต์และข้อโต้แย้ง</div>
            <div class="admin-controls">
                <button class="btn btn-primary" onclick="showAdminPanel()">จัดการแอดมิน</button>
                <button class="btn btn-logout" onclick="logout()">ออกจากระบบแอดมิน</button>
            </div>
        </header>
        
        <div class="main-content">
            <div class="panel">
                <h2 class="panel-title">คลังสคริปต์</h2>
                <div class="script-tabs">
                    <button class="tab active" onclick="switchTab('call')">Call Scripts</button>
                    <button class="tab" onclick="switchTab('counter')">Counter Conversation</button>
                    <button class="tab" onclick="switchTab('builder')">Conversation Builder</button>
                </div>
                <div class="script-list" id="scriptList">
                    <!-- สคริปต์จะถูกเพิ่มโดย JavaScript -->
                </div>
                <div class="script-content" id="scriptContent">
                    <!-- เนื้อหาสคริปต์จะแสดงที่นี่ -->
                </div>
                <div class="admin-panel hidden" id="adminPanel">
                    <h3>จัดการสคริปต์</h3>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddScriptForm()">เพิ่มสคริปต์ใหม่</button>
                        <button class="btn btn-primary" onclick="showAddArgumentForm()">เพิ่มข้อโต้แย้งใหม่</button>
                    </div>
                    <div class="upload-section">
                        <h4>อัพโหลดไฟล์</h4>
                        <input type="file" class="file-input" id="fileUpload">
                        <button class="btn btn-primary" onclick="uploadFile()">อัพโหลด</button>
                    </div>
                    
                    <!-- แบบฟอร์มเพิ่มสคริปต์ใหม่ -->
                    <div id="addScriptForm" class="hidden">
                        <h4>เพิ่มสคริปต์ใหม่</h4>
                        <div class="form-group">
                            <label class="form-label">หมวดหมู่</label>
                            <select class="form-input" id="scriptCategory">
                                <option value="call">Call Scripts</option>
                                <option value="counter">Counter Conversation</option>
                                <option value="builder">Conversation Builder</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ชื่อสคริปต์</label>
                            <input type="text" class="form-input" id="scriptTitle">
                        </div>
                        <div class="form-group">
                            <label class="form-label">เนื้อหาสคริปต์</label>
                            <textarea class="form-textarea" id="scriptContentInput"></textarea>
                        </div>
                        <div class="admin-actions">
                            <button class="btn btn-primary" onclick="saveNewScript()">บันทึก</button>
                            <button class="btn btn-danger" onclick="hideAddScriptForm()">ยกเลิก</button>
                        </div>
                    </div>
                    
                    <!-- แบบฟอร์มเพิ่มข้อโต้แย้งใหม่ -->
                    <div id="addArgumentForm" class="hidden">
                        <h4>เพิ่มข้อโต้แย้งใหม่</h4>
                        <div class="form-group">
                            <label class="form-label">ข้อโต้แย้ง</label>
                            <input type="text" class="form-input" id="argumentText">
                        </div>
                        <div class="form-group">
                            <label class="form-label">คำตอบ</label>
                            <textarea class="form-textarea" id="argumentResponseInput"></textarea>
                        </div>
                        <div class="admin-actions">
                            <button class="btn btn-primary" onclick="saveNewArgument()">บันทึก</button>
                            <button class="btn btn-danger" onclick="hideAddArgumentForm()">ยกเลิก</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title">คลังข้อโต้แย้งและการตอบ</h2>
                <div class="argument-list" id="argumentList">
                    <!-- ข้อโต้แย้งจะถูกเพิ่มโดย JavaScript -->
                </div>
                <div class="argument-response" id="argumentResponse">
                    <!-- คำตอบจะแสดงที่นี่ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ข้อมูลสคริปต์ทั้งหมด
        let scriptCategories = {
            call: [
                {
                    id: 1,
                    title: "เงินนิ่งในบัญชีเงินฝากเยอะเกินไป",
                    steps: {
                        objective: "เสนอผลิตภัณฑ์การลงทุนที่ให้ผลตอบแทนสูงกว่าเงินฝาก",
                        opener: "สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าบัญชีเงินฝากของคุณมียอดคงเหลือค่อนข้างสูง อยากแนะนำโอกาสในการลงทุนที่ให้ผลตอบแทนดีกว่าดอกเบี้ยเงินฝากทั่วไปครับ/ค่ะ",
                        pain: "ดอกเบี้ยเงินฝากในปัจจุบันต่ำมาก ทำให้เงินฝากเติบโตช้าและอาจไม่ชนะอัตราเงินเฟ้อ ซึ่งหมายความว่าคุณกำลังสูญเสียมูลค่าของเงินจริงๆ ไปเรื่อยๆ",
                        urgency: "โอกาสในการลงทุนที่ดีมักมีจำกัด และยิ่งเริ่มต้นเร็ว ยิ่งได้รับผลตอบแทนที่มากขึ้นในระยะยาว"
                    },
                    arguments: [
                        {
                            argument: "เงินฝากปลอดภัยกว่า",
                            response: "เข้าใจดีครับ/คะ เรื่องความปลอดภัยเป็นสิ่งสำคัญ ผลิตภัณฑ์นี้มีการลงทุนในสินทรัพย์คุณภาพสูงและมีความเสี่ยงต่ำ ซึ่งให้ผลตอบแทนที่ดีกว่าเงินฝากโดยมีความผันผวนที่ต่ำ"
                        },
                        {
                            argument: "ไม่มีความรู้ในการลงทุน",
                            response: "ไม่ต้องกังวลครับ/คะ เรามีทีมผู้เชี่ยวชาญที่พร้อมให้คำแนะนำและดูแลพอร์ตการลงทุนให้คุณอย่างใกล้ชิด รวมถึงมีบริการติดตามผลอย่างสม่ำเสมอ"
                        }
                    ]
                },
                {
                    id: 2,
                    title: "เงินฝากประจำกำลังจะครบ",
                    steps: {
                        objective: "เสนอทางเลือกการลงทุนที่หลากหลายแทนการต่ออายุเงินฝาก",
                        opener: "สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าเงินฝากประจำของคุณใกล้ครบกำหนดแล้ว อยากเสนอทางเลือกการลงทุนที่น่าสนใจให้พิจารณาครับ/ค่ะ",
                        pain: "การต่ออายุเงินฝากประจำโดยอัตโนมัติอาจทำให้พลาดโอกาสการลงทุนที่ให้ผลตอบแทนสูงกว่า และดอกเบี้ยเงินฝากในปัจจุบันอยู่ในระดับต่ำมาก",
                        urgency: "การตัดสินใจในช่วงเวลานี้สำคัญมาก เพราะจะกำหนดผลตอบแทนของคุณในอีก 12 เดือนข้างหน้า หากเลือกผลิตภัณฑ์ที่เหมาะสมจะได้รับผลตอบแทนที่สูงกว่า"
                    },
                    arguments: [
                        {
                            argument: "เคยชินกับเงินฝากประจำ",
                            response: "เข้าใจดีครับ/คะ แต่อยากให้ลองพิจารณาทางเลือกอื่นที่ให้ผลตอบแทนดีกว่าโดยยังมีความเสี่ยงต่ำ เช่น กองทุนรวมตลาดเงินหรือพันธบัตรรัฐบาลระยะสั้น"
                        },
                        {
                            argument: "กลัวความเสี่ยง",
                            response: "ผลิตภัณฑ์ที่เราเสนอมีการจัดการความเสี่ยงอย่างเป็นระบบและมีระดับความเสี่ยงที่เหมาะสมกับผู้เริ่มต้นลงทุน โดยมีทีมงานคอยให้คำแนะนำตลอดเวลา"
                        }
                    ]
                },
                {
                    id: 3,
                    title: "กองทุนติดลบจากความผันผวน",
                    steps: {
                        objective: "เสนอการปรับพอร์ตการลงทุนเพื่อลดความเสี่ยงและฟื้นตัวจากภาวะติดลบ",
                        opener: "สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าพอร์ตการลงทุนกองทุนของคุณได้รับผลกระทบจากความผันผวนของเศรษฐกิจ อยากเสนอแนวทางการปรับพอร์ตใหม่ให้เหมาะสมยิ่งขึ้นครับ/ค่ะ",
                        pain: "การที่พอร์ตการลงทุนติดลบเป็นเวลานานอาจทำให้สูญเสียโอกาสในการลงทุนอื่นๆ และส่งผลต่อเป้าหมายทางการเงินในระยะยาว",
                        urgency: "การปรับพอร์ตในช่วงนี้จะช่วยลดความเสี่ยงและเตรียมพร้อมสำหรับการฟื้นตัวของตลาด ซึ่งจะช่วยให้พอร์ตของคุณกลับมาเติบโตได้เร็วกว่า"
                    },
                    arguments: [
                        {
                            argument: "ไม่อยากขายขาดทุน",
                            response: "การปรับพอร์ตไม่จำเป็นต้องขายทั้งหมด อาจเป็นการปรับสัดส่วนการลงทุนเพื่อกระจายความเสี่ยงและเพิ่มสินทรัพย์ที่เหมาะสมกับสภาวะตลาดปัจจุบัน"
                        },
                        {
                            argument: "รอให้ตลาดฟื้นตัวก่อน",
                            response: "การรอให้ตลาดฟื้นตัวโดยไม่ทำอะไรอาจทำให้เสียโอกาสในการซื้อสินทรัพย์คุณภาพในราคาต่ำ ซึ่งจะช่วยเพิ่มศักยภาพในการทำกำไรเมื่อตลาดฟื้นตัว"
                        }
                    ]
                },
                {
                    id: 4,
                    title: "ลูกค้าประกันจ่ายเบี้ยครบ",
                    steps: {
                        objective: "เสนอการทบทวนแผนประกันและผลิตภัณฑ์เสริมเพื่อความคุ้มครองที่สมบูรณ์",
                        opener: "สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันเห็นว่าคุณได้จ่ายเบี้ยประกันชีวิตครบตามสัญญาแล้ว อยากเชิญชวนให้ทบทวนแผนประกันเพื่อตรวจสอบความคุ้มครองที่ยังขาดและโอกาสในการใช้สิทธิลดหย่อนภาษีครับ/ค่ะ",
                        pain: "ความต้องการประกันชีวิตเปลี่ยนแปลงตามช่วงวัยและสถานการณ์ การไม่ทบทวนแผนประกันอย่างสม่ำเสมออาจทำให้มีความคุ้มครองไม่เพียงพอหรือซ้ำซ้อน",
                        urgency: "การทำประกันในช่วงอายุน้อยกว่าเบี้ยจะถูกกว่าและได้รับความคุ้มครองเร็วขึ้น รวมถึงสามารถใช้สิทธิลดหย่อนภาษีในปีนี้ได้ทันเวลา"
                    },
                    arguments: [
                        {
                            argument: "มีประกันเพียงพอแล้ว",
                            response: "การมีประกันชีวิตพื้นฐานเป็นสิ่งดี แต่ชีวิตมีการเปลี่ยนแปลง เช่น การมีครอบครัว การซื้อบ้าน หรือการวางแผนเกษียณ ซึ่งอาจต้องการความคุ้มครองเพิ่มเติม"
                        },
                        {
                            argument: "ไม่ต้องการเพิ่มค่าใช้จ่าย",
                            response: "เรามีแผนประกันที่ออกแบบมาเฉพาะสำหรับลูกค้าที่จ่ายเบี้ยครบแล้ว ซึ่งมีเบี้ยประกันที่เหมาะสมและให้ความคุ้มครองที่ตรงกับความต้องการมากขึ้น"
                        }
                    ]
                },
                {
                    id: 5,
                    title: "ลูกค้าทั่วไปช่วง Tax Season",
                    steps: {
                        objective: "เชิญชวนใช้บริการคำนวณภาษีและวางแผนการลงทุนเพื่อลดหย่อนภาษี",
                        opener: "สวัสดีครับ/คะ คุณลูกค้า ช่วงสิ้นปีนี้เป็นเวลาที่เหมาะสำหรับการวางแผนภาษี ผม/ดิฉันอยากเชิญชวนคุณมาใช้บริการคำนวณภาษีและวางแผนการลดหย่อนภาษีโดยไม่เสียค่าใช้จ่ายครับ/ค่ะ",
                        pain: "การไม่วางแผนภาษีล่วงหน้าอาจทำให้ต้องเสียภาษีในอัตราที่สูงขึ้นและพลาดโอกาสในการใช้สิทธิลดหย่อนภาษีต่างๆ ซึ่งหมายถึงการจ่ายเงินมากเกินจำเป็น",
                        urgency: "ต้องรีบตัดสินใจในช่วงนี้เพราะจะสิ้นปีแล้ว และโปรโมชั่นต่างๆ สำหรับผลิตภัณฑ์ลดหย่อนภาษีมีข้อเสนอที่ดีที่สุดในช่วงนี้"
                    },
                    arguments: [
                        {
                            argument: "ยังไม่พร้อมคิดเรื่องภาษี",
                            response: "ยิ่งเริ่มต้นเร็วเท่าไหร่ ยิ่งมีเวลาวางแผนได้ดีขึ้น และสามารถเลือกผลิตภัณฑ์ลดหย่อนภาษีที่เหมาะสมที่สุดได้ โดยไม่ต้องรีบร้อนในช่วงใกล้ยื่นภาษี"
                        },
                        {
                            argument: "คิดว่าภาษีไม่มาก",
                            response: "ภาษีปีหนึ่งอาจมีมูลค่าประมาณเงินเดือน 1 เดือนเลยทีเดียว การวางแผนที่ดีสามารถช่วยประหยัดเงินก้อนนี้ได้ และยังเป็นการบังคับออมไปในตัว"
                        }
                    ]
                }
            ],
            counter: [
                {
                    id: 6,
                    title: "ขออัพเดทข้อมูลที่อยู่",
                    steps: {
                        step1: "ยืนยันข้อมูลลูกค้าและแจ้งวัตถุประสงค์: 'สวัสดีครับ/คะ คุณลูกค้า วันนี้โทรมาเพื่อขออัพเดทข้อมูลที่อยู่ให้เป็นปัจจุบันครับ/คะ เพื่อให้แน่ใจว่าสามารถส่งเอกสารสำคัญได้อย่างถูกต้อง'",
                        step2: "สร้างโอกาสในการขาย: 'นอกจากนี้ ผม/ดิฉันอยากใช้โอกาสนี้แจ้งว่าเรามีผลิตภัณฑ์ใหม่ที่เหมาะกับคุณ ซึ่งสามารถช่วยลดหย่อนภาษีได้สูงสุด 100,000 บาท และมีโปรโมชั่นพิเศษในช่วงสิ้นปีนี้'"
                    },
                    arguments: [
                        {
                            argument: "ไม่สะดวกให้ข้อมูลตอนนี้",
                            response: "เข้าใจครับ/คะ สามารถอัพเดทข้อมูลผ่านช่องทางอื่นได้ เช่น แอปพลิเคชันธนาคาร หรือสาขาใกล้บ้าน เมื่อสะดวกครับ/คะ"
                        },
                        {
                            argument: "ข้อมูลเดิมยังใช้ได้อยู่",
                            response: "การอัพเดทข้อมูลให้เป็นปัจจุบันจะช่วยให้เราส่งเอกสารสำคัญ เช่น หนังสือรับรองดอกเบี้ย สำหรับใช้สิทธิลดหย่อนภาษีได้อย่างถูกต้องและทันเวลา"
                        }
                    ]
                },
                {
                    id: 7,
                    title: "ชวนคุยเรื่องโครงการคนละครึ่งพลัส",
                    steps: {
                        step1: "แนะนำโปรแกรมและประโยชน์: 'สวัสดีครับ/คะ คุณลูกค้า วันนี้มีข่าวดีเกี่ยวกับโครงการคนละครึ่งพลัสที่จะช่วยให้คุณประหยัดค่าใช้จ่ายในชีวิตประจำวันและยังได้รับสิทธิพิเศษจากทางธนาคาร'",
                        step2: "เชื่อมโยงกับผลิตภัณฑ์: 'เมื่อร่วมโครงการนี้ คุณยังสามารถสมัครบัตรเครดิตหรือสินเชื่อส่วนบุคคลที่มีอัตราดอกเบี้ยพิเศษ และได้รับเงินคืนเมื่อใช้จ่ายผ่านช่องทางที่กำหนด'"
                    },
                    arguments: [
                        {
                            argument: "ไม่ค่อยใช้จ่ายมาก",
                            response: "โครงการนี้เหมาะกับทุกคน ไม่ว่าจะใช้จ่ายมากหรือน้อย เพราะมีเงื่อนไขที่ยืดหยุ่น และยังมีส่วนลดจากร้านค้าพันธมิตรที่คุณใช้บริการเป็นประจำ"
                        },
                        {
                            argument: "มีโปรแกรมคล้ายๆ กันแล้ว",
                            response: "โครงการคนละครึ่งพลัสนี้พิเศษกว่าตรงที่รัฐบาลและธนาคารร่วมสนับสนุน ทำให้ได้ส่วนลดสูงกว่าและมีร้านค้าร่วมโครงการมากกว่า"
                        }
                    ]
                },
                {
                    id: 8,
                    title: "แนะนำ Easy e-Receipt",
                    steps: {
                        step1: "อธิบายความสะดวก: 'สวัสดีครับ/คะ คุณลูกค้า ด้วยนวัตกรรมใหม่ Easy e-Receipt จะช่วยให้คุณเก็บเอกสารลดหย่อนภาษีได้อย่างเป็นระบบและไม่ต้องกังวลว่าจะสูญหาย'",
                        step2: "สร้างแรงจูงใจ: 'เริ่มใช้บริการตั้งแต่ต้นปี จะได้บันทึกใบเสร็จทั้งหมดโดยอัตโนมัติ และเมื่อถึงเวลายื่นภาษี ระบบจะสรุปข้อมูลให้คุณอย่างครบถ้วน พร้อมคำแนะนำการลดหย่อนภาษี'"
                    },
                    arguments: [
                        {
                            argument: "เก็บใบเสร็จเองได้อยู่แล้ว",
                            response: "Easy e-Receipt ช่วยประหยัดเวลาและลดความเสี่ยงจากการสูญหาย โดยเฉพาะใบเสร็จที่ต้องเก็บนานหลายเดือน และยังช่วยวิเคราะห์โอกาสลดหย่อนภาษีเพิ่มเติมที่คุณอาจไม่ทราบ"
                        },
                        {
                            argument: "ไม่มั่นใจในความปลอดภัย",
                            response: "ระบบมีการรักษาความปลอดภัยระดับสูงด้วยเทคโนโลยี encryption เช่นเดียวกับระบบการเงินอื่นๆ ของธนาคาร และข้อมูลจะไม่ถูกเปิดเผยแก่บุคคลที่สาม"
                        }
                    ]
                },
                {
                    id: 9,
                    title: "ภาษีดอกเบี้ยเงินฝาก",
                    steps: {
                        step1: "ระบุปัญหา: 'สวัสดีครับ/คะ คุณลูกค้า ผม/ดิฉันอยากแชร์ข้อมูลสำคัญเกี่ยวกับภาษีดอกเบี้ยเงินฝากที่คุณอาจสามารถขอคืนได้หากมีเงื่อนไขที่เหมาะสม'",
                        step2: "เสนอทางแก้: 'เรามีบริการตรวจสอบและยื่นขอคืนภาษีดอกเบี้ยเงินฝากให้ โดยทีมงานจะวิเคราะห์ว่าคุณมีสิทธิ์ได้รับเงินคืนหรือไม่ และดำเนินการให้โดยไม่เสียค่าใช้จ่าย'"
                    },
                    arguments: [
                        {
                            argument: "คิดว่าไม่มีสิทธิ์ได้รับคืน",
                            response: "หลายคนไม่ทราบว่าตนเองมีสิทธิ์ได้รับคืนภาษีดอกเบี้ยเงินฝาก โดยเฉพาะผู้ที่มีรายได้ไม่ถึงเกณฑ์หรือมีค่าใช้จ่ายลดหย่อนอื่นๆ ที่สามารถนำมาหักลดหย่อนได้"
                        },
                        {
                            argument: "ขั้นตอนยุ่งยาก",
                            response: "เราดำเนินการให้คุณเกือบทั้งหมด คุณเพียงแค่ให้ข้อมูลพื้นฐานและเราจะจัดการกระบวนการทั้งหมดจนเสร็จสิ้น"
                        }
                    ]
                },
                {
                    id: 10,
                    title: "วางแผนภาษีสิ้นปี",
                    steps: {
                        step1: "สร้างความตระหนัก: 'สวัสดีครับ/คะ คุณลูกค้า ช่วงสิ้นปีนี้เป็นเวลาสำหรับการวางแผนภาษี ผม/ดิฉันเห็นว่าลูกค้าหลายคนเริ่มสอบถามเกี่ยวกับเรื่องนี้แล้ว คุณมีการเตรียมตัวหรือยังครับ/คะ'",
                        step2: "แสดงมูลค่าที่เสียไป: 'หากยังไม่มีการวางแผน อาจทำให้เสียโอกาสในการลดหย่อนภาษี ซึ่งภาษีปีหนึ่งมีมูลค่าประมาณเท่ากับเงินเดือน 1 เดือนเลยทีเดียว'"
                    },
                    arguments: [
                        {
                            argument: "รอใกล้ยื่นภาษีค่อยคิด",
                            response: "การวางแผนล่วงหน้าช่วยให้คุณมีเวลาพิจารณาตัวเลือกลดหย่อนภาษีได้มากขึ้น และสามารถเลือกผลิตภัณฑ์ที่เหมาะสมกับความต้องการจริงๆ ไม่ใช่แค่เพื่อลดหย่อนภาษี"
                        },
                        {
                            argument: "ไม่รู้จะเริ่มยังไง",
                            response: "เรามีบริการให้คำปรึกษาการวางแผนภาษีฟรี โดยผู้เชี่ยวชาญจะวิเคราะห์สถานการณ์ทางการเงินของคุณและแนะนำวิธีลดหย่อนภาษีที่เหมาะสมที่สุด"
                        }
                    ]
                }
            ],
            builder: [
                {
                    id: 11,
                    title: "Conversation Builder - อัปเดตข้อมูลที่อยู่",
                    nodes: [
                        {
                            id: "node1",
                            content: "สวัสดีครับ/คะ คุณลูกค้า วันนี้โทรมาเพื่อขออัพเดทข้อมูลที่อยู่ให้เป็นปัจจุบันครับ/คะ",
                            options: [
                                {
                                    text: "ลูกค้ายินดีให้ข้อมูล",
                                    next: "node2"
                                },
                                {
                                    text: "ลูกค้าสงสัยว่าทำไมต้องอัพเดท",
                                    next: "node3"
                                },
                                {
                                    text: "ลูกค้าไม่สะดวกตอนนี้",
                                    next: "node4"
                                }
                            ]
                        },
                        {
                            id: "node2",
                            content: "ขอบคุณมากครับ/คะ สำหรับความร่วมมือ การอัพเดทข้อมูลจะช่วยให้เราส่งเอกสารสำคัญได้อย่างถูกต้อง",
                            options: [
                                {
                                    text: "แนะนำผลิตภัณฑ์ลดหย่อนภาษี",
                                    next: "node5"
                                },
                                {
                                    text: "สอบถามความสนใจอื่นๆ",
                                    next: "node6"
                                }
                            ]
                        },
                        {
                            id: "node3",
                            content: "การอัพเดทข้อมูลที่อยู่เป็นประจำช่วยให้แน่ใจว่าเราสามารถส่งเอกสารสำคัญ เช่น หนังสือรับรองดอกเบี้ยสำหรับใช้สิทธิลดหย่อนภาษี ได้อย่างถูกต้องและทันเวลา",
                            options: [
                                {
                                    text: "ลูกค้าเข้าใจและให้ข้อมูล",
                                    next: "node2"
                                },
                                {
                                    text: "ลูกค้ายังสงสัยเกี่ยวกับประโยชน์",
                                    next: "node7"
                                }
                            ]
                        },
                        {
                            id: "node4",
                            content: "เข้าใจครับ/คะ สามารถอัพเดทข้อมูลผ่านช่องทางอื่นได้ เช่น แอปพลิเคชันธนาคาร หรือสาขาใกล้บ้าน เมื่อสะดวกครับ/คะ",
                            options: [
                                {
                                    text: "นัดหมายเวลาที่สะดวก",
                                    next: "node8"
                                },
                                {
                                    text: "ส่งลิงก์อัพเดทผ่าน SMS",
                                    next: "node9"
                                }
                            ]
                        },
                        {
                            id: "node5",
                            content: "นอกจากนี้ ผม/ดิฉันอยากแชร์ว่าตอนนี้เรามีผลิตภัณฑ์ลดหย่อนภาษีที่น่าสนใจ สามารถลดหย่อนได้สูงสุด 100,000 บาท และมีโปรโมชั่นพิเศษในช่วงสิ้นปีนี้",
                            options: [
                                {
                                    text: "ลูกค้าสนใจทราบรายละเอียด",
                                    next: "node10"
                                },
                                {
                                    text: "ลูกค้าไม่สนใจตอนนี้",
                                    next: "node11"
                                }
                            ]
                        }
                        // สามารถเพิ่ม nodes อื่นๆ ตามต้องการ
                    ]
                }
                // สามารถเพิ่ม Conversation Builder อื่นๆ ตามต้องการ
            ]
        };

        // ข้อมูลข้อโต้แย้งและการตอบ
        let argumentsData = [
            {
                id: 1,
                argument: "ไม่มีเงินพอจะซื้อประกัน",
                response: "เข้าใจดีครับ/คะ เรื่องเงินเป็นเรื่องสำคัญ เรามีแผนประกันที่เริ่มต้นเพียงวันละ 20 บาทเท่านั้น ซึ่งถือว่าคุ้มค่ามากเมื่อเทียบกับความคุ้มครองที่ได้รับ"
            },
            {
                id: 2,
                argument: "ยังไม่แน่ใจเกี่ยวกับผลตอบแทน",
                response: "ผลตอบแทนของผลิตภัณฑ์นี้มีการการันตีอย่างชัดเจน โดยจะได้รับคืนปีละ 4% ในปีที่ 1-9 และเมื่อครบ 10 ปีจะได้รับ 404% ของเงินเบี้ยประกัน ซึ่งเป็นอัตราที่สูงกว่าการฝากเงินทั่วไป"
            },
            {
                id: 3,
                argument: "ต้องการปรึกษาครอบครัวก่อน",
                response: "เป็นการตัดสินใจที่ดีครับ/คะ ที่จะปรึกษาครอบครัว ขออนุญาตส่งข้อมูลรายละเอียดผลิตภัณฑ์ให้พิจารณาร่วมกัน และถ้ามีข้อสงสัยเพิ่มเติม ติดต่อกลับมาได้ตลอดเวลานะครับ/คะ"
            },
            {
                id: 4,
                argument: "เคยมีประสบการณ์ไม่ดีกับประกันมาก่อน",
                response: "ขอโทษแทนในประสบการณ์ที่ไม่ดีนั้นครับ/คะ ผลิตภัณฑ์นี้มีความโปร่งใสและเข้าใจง่าย คุณลูกค้าสามารถศึกษารายละเอียดทั้งหมดได้ด้วยตัวเองผ่าน ttb touch และมีทีมงานคอยให้คำแนะนำตลอดกระบวนการ"
            },
            {
                id: 5,
                argument: "เงินฝากปลอดภัยกว่า",
                response: "เข้าใจดีครับ/คะ เรื่องความปลอดภัยเป็นสิ่งสำคัญ ผลิตภัณฑ์นี้มีการลงทุนในสินทรัพย์คุณภาพสูงและมีความเสี่ยงต่ำ ซึ่งให้ผลตอบแทนที่ดีกว่าเงินฝากโดยมีความผันผวนที่ต่ำ"
            },
            {
                id: 6,
                argument: "ไม่มีความรู้ในการลงทุน",
                response: "ไม่ต้องกังวลครับ/คะ เรามีทีมผู้เชี่ยวชาญที่พร้อมให้คำแนะนำและดูแลพอร์ตการลงทุนให้คุณอย่างใกล้ชิด รวมถึงมีบริการติดตามผลอย่างสม่ำเสมอ"
            }
        ];

        let currentTab = 'call';
        let currentBuilderNode = null;

        // โหลดข้อมูลจาก localStorage ถ้ามี
        function loadFromLocalStorage() {
            const savedScripts = localStorage.getItem('scriptCategories');
            const savedArguments = localStorage.getItem('argumentsData');
            
            if (savedScripts) {
                scriptCategories = JSON.parse(savedScripts);
            }
            
            if (savedArguments) {
                argumentsData = JSON.parse(savedArguments);
            }
        }

        // บันทึกข้อมูลไปยัง localStorage
        function saveToLocalStorage() {
            localStorage.setItem('scriptCategories', JSON.stringify(scriptCategories));
            localStorage.setItem('argumentsData', JSON.stringify(argumentsData));
        }

        // โหลดสคริปต์เมื่อหน้าเว็บโหลดเสร็จ
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            loadScripts();
            loadArguments();
        });

        // สลับแท็บสคริปต์
        function switchTab(tabName) {
            currentTab = tabName;
            
            // อัพเดทแท็บที่ active
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // โหลดสคริปต์ใหม่ตามแท็บ
            loadScripts();
        }

        // โหลดและแสดงสคริปต์
        function loadScripts() {
            const scriptList = document.getElementById('scriptList');
            const scriptContent = document.getElementById('scriptContent');
            
            scriptList.innerHTML = '';
            scriptContent.innerHTML = '';
            
            const scripts = scriptCategories[currentTab];
            
            scripts.forEach(script => {
                const scriptItem = document.createElement('div');
                scriptItem.className = 'script-item';
                scriptItem.innerHTML = `
                    <span>${script.title}</span>
                    <div class="script-actions">
                        <button class="btn btn-primary" onclick="editScript(${script.id})">แก้ไข</button>
                        <button class="btn btn-danger" onclick="deleteScript(${script.id})">ลบ</button>
                    </div>
                `;
                scriptItem.onclick = function(e) {
                    // หลีกเลี่ยงการคลิกเมื่อกดปุ่มแก้ไขหรือลบ
                    if (e.target.tagName === 'BUTTON') return;
                    
                    // ลบคลาส active จากทุกสคริปต์
                    document.querySelectorAll('.script-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // เพิ่มคลาส active ให้สคริปต์ที่เลือก
                    scriptItem.classList.add('active');
                    
                    // แสดงเนื้อหาสคริปต์
                    displayScriptContent(script);
                };
                scriptList.appendChild(scriptItem);
            });
            
            // เลือกสคริปต์แรกโดยอัตโนมัติ
            if (scripts.length > 0) {
                scriptList.firstChild.click();
            }
        }

        // แสดงเนื้อหาสคริปต์
        function displayScriptContent(script) {
            const scriptContent = document.getElementById('scriptContent');
            scriptContent.innerHTML = '';
            
            if (currentTab === 'call') {
                // แสดง Call Scripts ในรูปแบบ Step
                for (const [step, content] of Object.entries(script.steps)) {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'script-step';
                    
                    const stepTitle = document.createElement('div');
                    stepTitle.className = 'step-title';
                    stepTitle.textContent = step.toUpperCase();
                    
                    const stepContent = document.createElement('div');
                    stepContent.textContent = content;
                    
                    stepDiv.appendChild(stepTitle);
                    stepDiv.appendChild(stepContent);
                    scriptContent.appendChild(stepDiv);
                }
                
                // แสดงข้อโต้แย้งที่เกี่ยวข้อง
                if (script.arguments && script.arguments.length > 0) {
                    const argumentsTitle = document.createElement('div');
                    argumentsTitle.className = 'step-title';
                    argumentsTitle.textContent = 'ข้อโต้แย้งที่เกี่ยวข้อง';
                    argumentsTitle.style.marginTop = '20px';
                    scriptContent.appendChild(argumentsTitle);
                    
                    script.arguments.forEach(arg => {
                        const argDiv = document.createElement('div');
                        argDiv.style.margin = '10px 0';
                        argDiv.style.padding = '10px';
                        argDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.5)';
                        argDiv.style.borderRadius = '5px';
                        
                        const argTitle = document.createElement('div');
                        argTitle.style.fontWeight = '600';
                        argTitle.textContent = `ข้อโต้แย้ง: ${arg.argument}`;
                        
                        const argResponse = document.createElement('div');
                        argResponse.textContent = `คำตอบ: ${arg.response}`;
                        
                        argDiv.appendChild(argTitle);
                        argDiv.appendChild(argResponse);
                        scriptContent.appendChild(argDiv);
                    });
                }
            } else if (currentTab === 'counter') {
                // แสดง Counter Conversation Scripts
                for (const [step, content] of Object.entries(script.steps)) {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'script-step';
                    
                    const stepTitle = document.createElement('div');
                    stepTitle.className = 'step-title';
                    stepTitle.textContent = step.toUpperCase();
                    
                    const stepContent = document.createElement('div');
                    stepContent.textContent = content;
                    
                    stepDiv.appendChild(stepTitle);
                    stepDiv.appendChild(stepContent);
                    scriptContent.appendChild(stepDiv);
                }
                
                // แสดงข้อโต้แย้งที่เกี่ยวข้อง
                if (script.arguments && script.arguments.length > 0) {
                    const argumentsTitle = document.createElement('div');
                    argumentsTitle.className = 'step-title';
                    argumentsTitle.textContent = 'ข้อโต้แย้งที่เกี่ยวข้อง';
                    argumentsTitle.style.marginTop = '20px';
                    scriptContent.appendChild(argumentsTitle);
                    
                    script.arguments.forEach(arg => {
                        const argDiv = document.createElement('div');
                        argDiv.style.margin = '10px 0';
                        argDiv.style.padding = '10px';
                        argDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.5)';
                        argDiv.style.borderRadius = '5px';
                        
                        const argTitle = document.createElement('div');
                        argTitle.style.fontWeight = '600';
                        argTitle.textContent = `ข้อโต้แย้ง: ${arg.argument}`;
                        
                        const argResponse = document.createElement('div');
                        argResponse.textContent = `คำตอบ: ${arg.response}`;
                        
                        argDiv.appendChild(argTitle);
                        argDiv.appendChild(argResponse);
                        scriptContent.appendChild(argDiv);
                    });
                }
            } else if (currentTab === 'builder') {
                // แสดง Conversation Builder
                currentBuilderNode = script.nodes[0];
                displayBuilderNode(currentBuilderNode, scriptContent);
            }
        }

        // แสดงโหนดของ Conversation Builder
        function displayBuilderNode(node, container) {
            container.innerHTML = '';
            
            const nodeDiv = document.createElement('div');
            nodeDiv.className = 'conversation-node';
            nodeDiv.textContent = node.content;
            container.appendChild(nodeDiv);
            
            if (node.options && node.options.length > 0) {
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'node-options';
                
                node.options.forEach(option => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'node-option';
                    optionDiv.textContent = option.text;
                    optionDiv.onclick = function() {
                        const nextNode = scriptCategories.builder[0].nodes.find(n => n.id === option.next);
                        if (nextNode) {
                            displayBuilderNode(nextNode, container);
                        }
                    };
                    optionsDiv.appendChild(optionDiv);
                });
                
                container.appendChild(optionsDiv);
            }
        }

        // โหลดและแสดงข้อโต้แย้ง
        function loadArguments() {
            const argumentList = document.getElementById('argumentList');
            const argumentResponse = document.getElementById('argumentResponse');
            
            argumentList.innerHTML = '';
            argumentResponse.innerHTML = '';
            
            argumentsData.forEach(arg => {
                const argumentItem = document.createElement('div');
                argumentItem.className = 'argument-item';
                argumentItem.innerHTML = `
                    <span>${arg.argument}</span>
                    <div class="argument-actions">
                        <button class="btn btn-primary" onclick="editArgument(${arg.id})">แก้ไข</button>
                        <button class="btn btn-danger" onclick="deleteArgument(${arg.id})">ลบ</button>
                    </div>
                `;
                argumentItem.onclick = function(e) {
                    // หลีกเลี่ยงการคลิกเมื่อกดปุ่มแก้ไขหรือลบ
                    if (e.target.tagName === 'BUTTON') return;
                    
                    // ลบคลาส active จากทุกข้อโต้แย้ง
                    document.querySelectorAll('.argument-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // เพิ่มคลาส active ให้ข้อโต้แย้งที่เลือก
                    argumentItem.classList.add('active');
                    
                    // แสดงคำตอบ
                    argumentResponse.textContent = arg.response;
                };
                argumentList.appendChild(argumentItem);
            });
            
            // เลือกข้อโต้แย้งแรกโดยอัตโนมัติ
            if (argumentsData.length > 0) {
                argumentList.firstChild.click();
            }
        }

        // แสดงแผงแอดมิน
        function showAdminPanel() {
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.classList.toggle('hidden');
        }

        // แสดงฟอร์มเพิ่มสคริปต์
        function showAddScriptForm() {
            document.getElementById('addScriptForm').classList.remove('hidden');
            document.getElementById('addArgumentForm').classList.add('hidden');
        }

        // ซ่อนฟอร์มเพิ่มสคริปต์
        function hideAddScriptForm() {
            document.getElementById('addScriptForm').classList.add('hidden');
        }

        // แสดงฟอร์มเพิ่มข้อโต้แย้ง
        function showAddArgumentForm() {
            document.getElementById('addArgumentForm').classList.remove('hidden');
            document.getElementById('addScriptForm').classList.add('hidden');
        }

        // ซ่อนฟอร์มเพิ่มข้อโต้แย้ง
        function hideAddArgumentForm() {
            document.getElementById('addArgumentForm').classList.add('hidden');
        }

        // บันทึกสคริปต์ใหม่
        function saveNewScript() {
            const category = document.getElementById('scriptCategory').value;
            const title = document.getElementById('scriptTitle').value;
            const content = document.getElementById('scriptContentInput').value;
            
            if (!title || !content) {
                alert('กรุณากรอกชื่อและเนื้อหาสคริปต์');
                return;
            }
            
            // สร้างสคริปต์ใหม่
            const newScript = {
                id: Date.now(), // ใช้ timestamp เป็น ID
                title: title,
                steps: {
                    objective: content,
                    opener: '',
                    pain: '',
                    urgency: ''
                },
                arguments: []
            };
            
            // เพิ่มสคริปต์ใหม่ลงในหมวดหมู่
            scriptCategories[category].push(newScript);
            
            // บันทึกข้อมูล
            saveToLocalStorage();
            
            // โหลดสคริปต์ใหม่
            loadScripts();
            
            // ซ่อนฟอร์ม
            hideAddScriptForm();
            
            // รีเซ็ตฟอร์ม
            document.getElementById('scriptTitle').value = '';
            document.getElementById('scriptContentInput').value = '';
            
            alert('เพิ่มสคริปต์ใหม่เรียบร้อยแล้ว!');
        }

        // บันทึกข้อโต้แย้งใหม่
        function saveNewArgument() {
            const argument = document.getElementById('argumentText').value;
            const response = document.getElementById('argumentResponseInput').value;
            
            if (!argument || !response) {
                alert('กรุณากรอกข้อโต้แย้งและคำตอบ');
                return;
            }
            
            // สร้างข้อโต้แย้งใหม่
            const newArgument = {
                id: Date.now(), // ใช้ timestamp เป็น ID
                argument: argument,
                response: response
            };
            
            // เพิ่มข้อโต้แย้งใหม่
            argumentsData.push(newArgument);
            
            // บันทึกข้อมูล
            saveToLocalStorage();
            
            // โหลดข้อโต้แย้งใหม่
            loadArguments();
            
            // ซ่อนฟอร์ม
            hideAddArgumentForm();
            
            // รีเซ็ตฟอร์ม
            document.getElementById('argumentText').value = '';
            document.getElementById('argumentResponseInput').value = '';
            
            alert('เพิ่มข้อโต้แย้งใหม่เรียบร้อยแล้ว!');
        }

        // แก้ไขสคริปต์
        function editScript(id) {
            // หาสคริปต์ที่ต้องการแก้ไข
            let scriptToEdit = null;
            let categoryToEdit = null;
            
            for (const category in scriptCategories) {
                const script = scriptCategories[category].find(s => s.id === id);
                if (script) {
                    scriptToEdit = script;
                    categoryToEdit = category;
                    break;
                }
            }
            
            if (!scriptToEdit) return;
            
            // แสดงฟอร์มแก้ไข
            const newTitle = prompt('แก้ไขชื่อสคริปต์:', scriptToEdit.title);
            if (newTitle) {
                scriptToEdit.title = newTitle;
                
                // บันทึกข้อมูล
                saveToLocalStorage();
                
                // โหลดสคริปต์ใหม่
                loadScripts();
                
                alert('แก้ไขสคริปต์เรียบร้อยแล้ว!');
            }
        }

        // ลบสคริปต์
        function deleteScript(id) {
            if (!confirm('คุณแน่ใจว่าต้องการลบสคริปต์นี้?')) return;
            
            // ลบสคริปต์
            for (const category in scriptCategories) {
                const index = scriptCategories[category].findIndex(s => s.id === id);
                if (index !== -1) {
                    scriptCategories[category].splice(index, 1);
                    break;
                }
            }
            
            // บันทึกข้อมูล
            saveToLocalStorage();
            
            // โหลดสคริปต์ใหม่
            loadScripts();
            
            alert('ลบสคริปต์เรียบร้อยแล้ว!');
        }

        // แก้ไขข้อโต้แย้ง
        function editArgument(id) {
            // หาข้อโต้แย้งที่ต้องการแก้ไข
            const argumentToEdit = argumentsData.find(a => a.id === id);
            if (!argumentToEdit) return;
            
            // แสดงฟอร์มแก้ไข
            const newArgument = prompt('แก้ไขข้อโต้แย้ง:', argumentToEdit.argument);
            if (newArgument) {
                argumentToEdit.argument = newArgument;
                
                const newResponse = prompt('แก้ไขคำตอบ:', argumentToEdit.response);
                if (newResponse) {
                    argumentToEdit.response = newResponse;
                    
                    // บันทึกข้อมูล
                    saveToLocalStorage();
                    
                    // โหลดข้อโต้แย้งใหม่
                    loadArguments();
                    
                    alert('แก้ไขข้อโต้แย้งเรียบร้อยแล้ว!');
                }
            }
        }

        // ลบข้อโต้แย้ง
        function deleteArgument(id) {
            if (!confirm('คุณแน่ใจว่าต้องการลบข้อโต้แย้งนี้?')) return;
            
            // ลบข้อโต้แย้ง
            const index = argumentsData.findIndex(a => a.id === id);
            if (index !== -1) {
                argumentsData.splice(index, 1);
            }
            
            // บันทึกข้อมูล
            saveToLocalStorage();
            
            // โหลดข้อโต้แย้งใหม่
            loadArguments();
            
            alert('ลบข้อโต้แย้งเรียบร้อยแล้ว!');
        }

        // อัพโหลดไฟล์
        function uploadFile() {
            const fileInput = document.getElementById('fileUpload');
            if (fileInput.files.length > 0) {
                const fileName = fileInput.files[0].name;
                alert(`อัพโหลดไฟล์ "${fileName}" เรียบร้อยแล้ว!`);
                // ในระบบจริงควรมีโค้ดสำหรับอัพโหลดไฟล์ไปยังเซิร์ฟเวอร์
                
                // รีเซ็ต input file
                fileInput.value = '';
            } else {
                alert("กรุณาเลือกไฟล์ก่อนอัพโหลด");
            }
        }

        // ออกจากระบบแอดมิน
        function logout() {
            if (confirm("คุณแน่ใจว่าต้องการออกจากระบบแอดมิน?")) {
                const adminPanel = document.getElementById('adminPanel');
                adminPanel.classList.add('hidden');
                alert("ออกจากระบบแอดมินเรียบร้อยแล้ว");
            }
        }
    </script>
</body>
</html>
